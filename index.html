<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ü–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∏–≥—Ä—ã "–°–Ω–µ–≥–æ–≤–∏–∫"</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #2c3e50, #4a6491);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        background-color: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        transition: margin-top 0.3s ease;
      }

      header {
        text-align: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #eee;
      }

      h1 {
        color: #2c3e50;
        margin-bottom: 10px;
        font-size: 2rem;
      }

      .subtitle {
        color: #555;
        font-size: 1rem;
        max-width: 800px;
        margin: 0 auto 10px;
      }

      .game-area {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 20px;
      }

      /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º */
      .top-controls {
        display: flex;
        justify-content: space-between;
        width: 100%;
        max-width: 500px;
        margin-bottom: 15px;
      }

      .export-import {
        display: flex;
        gap: 10px;
      }

      /* –ò–≥—Ä–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */
      .game-info {
        display: flex;
        justify-content: space-between;
        width: 100%;
        max-width: 500px;
        margin-bottom: 15px;
        background-color: #f5f5f5;
        padding: 12px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .info-item {
        text-align: center;
        flex: 1;
      }

      .info-value {
        font-size: 1.4rem;
        font-weight: bold;
        color: #2c3e50;
      }

      .info-label {
        font-size: 0.8rem;
        color: #666;
      }

      /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
      .game-board {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        grid-template-rows: repeat(5, 1fr);
        gap: 4px;
        margin-bottom: 20px;
        background-color: #34495e;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      }

      .cell {
        width: 70px;
        height: 70px;
        background-color: #bdc3c7;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.3rem;
        cursor: pointer;
        transition: all 0.2s ease;
        user-select: none;
        border: 2px solid #95a5a6;
        position: relative;
      }

      .cell:hover {
        transform: scale(1.05);
        box-shadow: 0 0 8px rgba(255, 255, 255, 0.7);
      }

      .cell.unknown {
        background-color: #bdc3c7;
        color: #2c3e50;
      }

      .cell.normal {
        background-color: #ecf0f1;
        color: #333;
      }

      .cell.gold {
        background-color: #ffd700;
        color: #b8860b;
        box-shadow: inset 0 0 10px rgba(184, 134, 11, 0.5);
      }

      .cell.empty {
        background-color: #7f8c8d;
        color: #ecf0f1;
      }

      .cell.possible-gold {
        background-color: #ffeb3b;
        color: #b8860b;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(255, 235, 59, 0.7);
        }
        70% {
          box-shadow: 0 0 0 5px rgba(255, 235, 59, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(255, 235, 59, 0);
        }
      }

      .cell.gold-outline {
        border: 2px solid #ffa500;
        box-shadow: 0 0 5px rgba(255, 165, 0, 0.7);
      }

      /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ö–æ–¥–∞ */
      .cell.next-move-hint {
        animation: nextMovePulse 1.5s infinite;
        border: 3px solid #27ae60;
        box-shadow: 0 0 15px rgba(39, 174, 96, 0.7);
        z-index: 10;
      }

      @keyframes nextMovePulse {
        0% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7);
        }
        70% {
          transform: scale(1.05);
          box-shadow: 0 0 0 10px rgba(39, 174, 96, 0);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(39, 174, 96, 0);
        }
      }

      /* –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –∫–Ω–æ–ø–∫–∞–º–∏ */
      .bottom-controls {
        display: flex;
        justify-content: space-between;
        width: 100%;
        max-width: 500px;
        margin-bottom: 20px;
      }

      .left-controls,
      .right-controls {
        display: flex;
        gap: 10px;
      }

      .btn {
        padding: 12px 20px;
        border: none;
        border-radius: 6px;
        font-size: 0.9rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 44px;
      }

      .btn-primary {
        background-color: #2c3e50;
        color: white;
      }

      .btn-primary:hover {
        background-color: #34495e;
      }

      .btn-secondary {
        background-color: #bfbfbf;
        color: white;
      }

      .btn-secondary:hover {
        background-color: #adabab;
      }

      .btn-outline-mode {
        background-color: #f39c12;
        color: white;
      }

      .btn-outline-mode:hover {
        background-color: #e67e22;
      }

      .btn-outline-mode.active {
        background-color: #d35400;
        box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
      }

      .btn-next-move {
        background-color: #27ae60;
        color: white;
      }

      .btn-next-move:hover {
        background-color: #2ecc71;
      }

      .btn-next-move.active {
        background-color: #1e8449;
        box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
      }

      .btn-icon {
        font-size: 1.2rem;
        line-height: 1;
      }

      .btn-with-text {
        padding-left: 15px;
        padding-right: 15px;
      }

      .cell-number {
        position: absolute;
        top: 2px;
        left: 2px;
        font-size: 0.65rem;
        color: #666;
      }

      .gold-chance {
        position: absolute;
        bottom: 2px;
        right: 2px;
        font-size: 0.75rem;
        font-weight: bold;
      }

      .gold-chance.high {
        color: #b8860b;
        font-weight: bold;
      }

      .gold-chance.low {
        color: #95a5a6;
        font-weight: normal;
      }

      /* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ */
      .instructions {
        background-color: #f9f9f9;
        padding: 15px;
        border-radius: 8px;
        border-left: 5px solid #2c3e50;
        font-size: 0.9rem;
        margin-bottom: 20px;
      }

      .instructions h3 {
        color: #2c3e50;
        margin-bottom: 10px;
        font-size: 1.1rem;
      }

      .instructions ul {
        padding-left: 18px;
        margin-bottom: 10px;
      }

      .instructions li {
        margin-bottom: 5px;
      }

      .legend {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        margin-top: 10px;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.8rem;
      }

      .legend-color {
        width: 20px;
        height: 20px;
        border-radius: 3px;
        border: 1px solid #ccc;
      }

      /* –¢–∞–∫—Ç–∏–∫–∏ */
      .tactics-section {
        margin-bottom: 20px;
      }

      .section-title {
        color: #2c3e50;
        text-align: center;
        margin-bottom: 15px;
        font-size: 1.3rem;
        position: relative;
        padding-bottom: 8px;
      }

      .section-title:after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 100px;
        height: 3px;
        background-color: #f39c12;
        border-radius: 2px;
      }

      .tactics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 25px;
      }

      .tactic-card {
        background-color: #f5f5f5;
        border-radius: 8px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border: 2px solid transparent;
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      .tactic-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        border-color: #f39c12;
      }

      .tactic-card.gold {
        border-top: 4px solid #ffd700;
      }

      .tactic-card.silver {
        border-top: 4px solid #bdc3c7;
      }

      .tactic-card.bronze {
        border-top: 4px solid #cd7f32;
      }

      .tactic-card.blue {
        border-top: 4px solid #3498db;
      }

      .tactic-card h4 {
        color: #2c3e50;
        margin-bottom: 10px;
        font-size: 1rem;
        text-align: center;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .tactic-card .rank {
        display: inline-block;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background-color: #2c3e50;
        color: white;
        text-align: center;
        line-height: 24px;
        font-size: 0.8rem;
        margin-right: 8px;
        vertical-align: middle;
      }

      .tactic-preview {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        grid-template-rows: repeat(5, 1fr);
        gap: 3px;
        width: 100%;
        background-color: #34495e;
        padding: 6px;
        border-radius: 4px;
        flex-grow: 1;
      }

      .preview-cell {
        aspect-ratio: 1 / 1;
        flex: 1 0 auto;
        border-radius: 2px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.7rem;
        font-weight: bold;
        overflow: hidden;
      }

      .tactic-description {
        font-size: 0.85rem;
        color: #555;
        line-height: 1.4;
        margin-top: 8px;
        max-height: 60px;
        overflow: hidden;
      }

      /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .modal {
        background-color: white;
        border-radius: 10px;
        padding: 25px;
        max-width: 700px;
        max-height: 85vh;
        overflow-y: auto;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        transform: translateY(-20px);
        transition: transform 0.3s ease;
      }

      .modal-overlay.active .modal {
        transform: translateY(0);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        border-bottom: 2px solid #eee;
        padding-bottom: 15px;
      }

      .modal-title {
        color: #2c3e50;
        font-size: 1.3rem;
        margin: 0;
        display: flex;
        align-items: center;
      }

      .modal-title .rank {
        display: inline-block;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background-color: #2c3e50;
        color: white;
        text-align: center;
        line-height: 30px;
        font-size: 0.9rem;
        margin-right: 12px;
      }

      .close-modal {
        background: none;
        border: none;
        font-size: 1.8rem;
        cursor: pointer;
        color: #7f8c8d;
        transition: color 0.3s ease;
        line-height: 1;
      }

      .close-modal:hover {
        color: #e74c3c;
      }

      .modal-content {
        color: #333;
      }

      .tactic-explanation {
        margin-bottom: 20px;
      }

      .tactic-explanation h4 {
        color: #2c3e50;
        margin-bottom: 10px;
        font-size: 1.1rem;
      }

      .tactic-explanation p {
        margin-bottom: 12px;
        line-height: 1.6;
      }

      .tactic-explanation ul,
      .tactic-explanation ol {
        padding-left: 20px;
        margin-bottom: 15px;
      }

      .tactic-explanation li {
        margin-bottom: 8px;
        line-height: 1.5;
      }

      .tactic-visualization {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 20px;
      }

      .tactic-board {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        grid-template-rows: repeat(5, 1fr);
        gap: 4px;
        width: 350px;
        height: 290px;
        background-color: #34495e;
        padding: 12px;
        border-radius: 6px;
        margin-bottom: 15px;
      }

      .visual-cell {
        width: 100%;
        height: 100%;
        border-radius: 3px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
        font-weight: bold;
      }

      .visual-cell.normal {
        background-color: #ecf0f1;
      }

      .visual-cell.gold-outline {
        background-color: #ecf0f1;
        border: 2px solid #ffa500;
      }

      .visual-cell.gold {
        background-color: #ffd700;
      }

      .visual-cell.empty {
        background-color: #7f8c8d;
        color: white;
      }

      .visual-cell.target {
        background-color: #ffeb3b;
        animation: pulse 2s infinite;
      }

      .visual-cell.start {
        background-color: #a3e4d7;
      }

      .visual-label {
        font-size: 0.9rem;
        color: #666;
        margin-top: 8px;
        text-align: center;
        max-width: 350px;
      }

      .coordinate-list {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 10px;
        margin: 15px 0;
      }

      .coordinate-item {
        background-color: #f1f8ff;
        padding: 8px 12px;
        border-radius: 4px;
        font-weight: bold;
        color: #2c3e50;
        border: 1px solid #d1e3ff;
      }

      /* –≠–∫—Å–ø–æ—Ä—Ç/–ò–º–ø–æ—Ä—Ç */
      .export-import-modal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        border-radius: 10px;
        padding: 25px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        z-index: 1001;
        display: none;
      }

      .export-import-modal.active {
        display: block;
      }

      .export-import-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        display: none;
      }

      .export-import-overlay.active {
        display: block;
      }

      .code-container {
        display: flex;
        align-items: center;
        gap: 10px;
        background-color: #2c3e50;
        border-radius: 6px;
        padding: 12px;
        margin: 10px 0;
      }

      .code-content {
        flex: 1;
        color: #ecf0f1;
        font-family: "Courier New", monospace;
        padding: 8px;
        overflow-x: auto;
        background-color: rgba(0, 0, 0, 0.2);
        border-radius: 4px;
        min-height: 40px;
        display: flex;
        align-items: center;
      }

      .copy-btn {
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 8px 16px;
        cursor: pointer;
        font-size: 0.9rem;
        white-space: nowrap;
        transition: background-color 0.3s;
      }

      .copy-btn:hover {
        background-color: #2980b9;
      }

      .copy-btn.copied {
        background-color: #27ae60;
      }

      .import-input {
        width: 100%;
        padding: 10px;
        border: 2px solid #bdc3c7;
        border-radius: 4px;
        font-family: "Courier New", monospace;
        margin: 10px 0;
      }

      .import-input:focus {
        border-color: #3498db;
        outline: none;
      }

      .import-status {
        margin-top: 10px;
        padding: 10px;
        border-radius: 4px;
        display: none;
      }

      .import-status.success {
        background-color: #d5edda;
        color: #155724;
        border: 1px solid #c3e6cb;
        display: block;
      }

      .import-status.error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
        display: block;
      }

      .author-note {
        text-align: center;
        color: #7f8c8d;
        font-size: 0.85rem;
        margin-top: 20px;
        padding-top: 15px;
        border-top: 1px solid #eee;
      }

      @media (max-width: 768px) {
        .container {
          padding: 20px;
        }

        h1 {
          font-size: 1.7rem;
        }

        .cell {
          width: 48px;
          height: 48px;
          font-size: 1.1rem;
        }

        .btn {
          padding: 10px 15px;
        }

        .tactics-grid {
          grid-template-columns: 1fr;
        }

        .modal {
          max-width: 95%;
          padding: 20px;
        }

        .tactic-board {
          width: 280px;
          height: 230px;
        }
      }
      @media (max-width: 480px) {
        .subtitle {
          font-size: 0.9rem;
        }
      }

      @media (max-width: 480px) {
        .cell {
          width: 42px;
          height: 42px;
          font-size: 1rem;
        }

        .game-info {
          justify-content: center;
          flex-wrap: wrap;
          flex-direction: row;
          gap: 6px;
          padding: 8px 10px;
        }

        .info-item {
          flex: 0 0 auto;
          min-width: 70px;
        }

        .instructions {
          padding: 12px;
        }

        .tactic-board {
          width: 240px;
          height: 200px;
        }

        .btn {
          padding: 8px 12px;
        }
      }

      /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª–∫–∏ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ */
      .first-launch-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.85);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 3000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .first-launch-modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .first-launch-modal {
        background: linear-gradient(135deg, #2c3e50, #4a6491);
        border-radius: 15px;
        width: 90%;
        max-width: 700px;
        max-height: 85vh;
        overflow: hidden;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        animation: modalAppear 0.5s ease-out;
      }

      @keyframes modalAppear {
        from {
          opacity: 0;
          transform: translateY(-30px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .first-launch-header {
        background: rgba(0, 0, 0, 0.2);
        padding: 20px 30px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .first-launch-header h2 {
        color: white;
        font-size: 1.5rem;
        margin: 0;
      }

      .first-launch-close {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        font-size: 2rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.3s;
      }

      .first-launch-close:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .first-launch-content {
        padding: 30px;
        max-height: 60vh;
        overflow-y: auto;
      }

      .tutorial-step {
        display: none;
        animation: fadeIn 0.5s ease;
      }

      .tutorial-step.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .step-icon {
        font-size: 3rem;
        text-align: center;
        margin-bottom: 20px;
      }

      .tutorial-step h3 {
        color: white;
        margin-bottom: 15px;
        font-size: 1.3rem;
        text-align: center;
      }

      .tutorial-step p {
        color: rgba(255, 255, 255, 0.9);
        line-height: 1.6;
        margin-bottom: 15px;
        text-align: center;
      }

      .tutorial-list {
        list-style: none;
        padding: 0;
        margin: 20px 0;
      }

      .tutorial-list li {
        color: white;
        margin-bottom: 12px;
        padding-left: 25px;
        position: relative;
      }

      .tutorial-list li:before {
        content: "‚úì";
        position: absolute;
        left: 0;
        color: #2ecc71;
        font-weight: bold;
      }

      .mini-board {
        display: inline-grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 5px;
        background: #34495e;
        padding: 10px;
        border-radius: 8px;
        margin: 15px auto;
      }

      .mini-cell {
        width: 30px;
        height: 30px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }

      .mini-cell.unknown {
        background-color: #bdc3c7;
      }

      .mini-cell.normal {
        background-color: #ecf0f1;
      }

      .mini-cell.gold {
        background-color: #ffd700;
      }

      .mini-cell.empty {
        background-color: #7f8c8d;
      }

      .legend-demo {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .legend-demo .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .legend-demo .legend-color {
        width: 20px;
        height: 20px;
        border-radius: 3px;
      }

      .legend-demo .legend-color.unknown {
        background-color: #bdc3c7;
      }

      .legend-demo .legend-color.normal {
        background-color: #ecf0f1;
      }

      .legend-demo .legend-color.gold {
        background-color: #ffd700;
      }

      .controls-demo {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin: 20px 0;
      }

      .control-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }

      .demo-btn {
        padding: 10px 15px;
        border: none;
        border-radius: 6px;
        font-weight: bold;
        cursor: default;
        min-width: 120px;
        pointer-events: none;
      }

      .control-item span {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
        text-align: center;
      }

      .tactics-preview {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .tactic-mini {
        background: rgba(255, 255, 255, 0.1);
        padding: 12px 20px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        gap: 10px;
        color: white;
        min-width: 180px;
      }

      .tactic-mini.gold {
        border-left: 4px solid #ffd700;
      }

      .tactic-mini.silver {
        border-left: 4px solid #bdc3c7;
      }

      .tactic-mini.bronze {
        border-left: 4px solid #cd7f32;
      }

      .tactic-rank {
        background: rgba(255, 255, 255, 0.2);
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }

      .dev-notice {
        background: rgba(0, 0, 0, 0.2);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }

      .dev-notice p {
        text-align: left;
      }

      .bug-report {
        background: rgba(231, 76, 60, 0.1);
        padding: 15px;
        border-radius: 8px;
        margin-top: 15px;
        border-left: 4px solid #e74c3c;
      }

      .contact-links {
        display: flex;
        gap: 15px;
        margin-top: 15px;
        justify-content: center;
      }

      .contact-link {
        padding: 10px 20px;
        border-radius: 6px;
        text-decoration: none;
        font-weight: bold;
        color: white;
        transition: transform 0.3s, opacity 0.3s;
      }

      .contact-link.vk {
        background: #4a76a8;
      }

      .contact-link.github {
        background: #333;
      }

      .contact-link:hover {
        transform: translateY(-2px);
        opacity: 0.9;
      }

      .dont-show-again {
        color: white;
      }

      .dont-show-again label {
        color: white;
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
      }

      .dont-show-again input[type="checkbox"] {
        width: 18px;
        height: 18px;
      }

      .first-launch-footer {
        background: rgba(0, 0, 0, 0.2);
        padding: 20px 30px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .step-indicators {
        display: flex;
        gap: 10px;
      }

      .step-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        cursor: pointer;
        transition: background 0.3s;
      }

      .step-dot.active {
        background: #3498db;
      }

      #prev-step:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      @media (max-width: 768px) {
        .first-launch-close {
          min-width: 40px;
        }

        .first-launch-modal {
          width: 95%;
          max-height: 90vh;
        }

        .first-launch-content {
          padding: 20px;
          max-height: 60vh;
        }

        .controls-demo {
          grid-template-columns: 1fr;
        }

        .tactics-preview {
          flex-direction: column;
          align-items: center;
        }

        .contact-links {
          flex-direction: column;
        }
        .step-icon {
          display: none;
        }
      }
      /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª–∫–∏ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ */
      .step-icon {
        font-size: 2.5rem;
        margin-bottom: 15px;
        opacity: 0.9;
      }

      .interactive-demo {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
        text-align: center;
      }

      .demo-instruction {
        color: rgba(255, 255, 255, 0.9);
        margin-bottom: 15px;
        font-size: 1rem;
      }

      .demo-cell-container {
        display: flex;
        justify-content: center;
        margin: 20px 0;
      }

      .demo-cell {
        width: 70px;
        height: 70px;
        background-color: #bdc3c7;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: bold;
        cursor: pointer;
        position: relative;
        transition: all 0.2s ease;
        border: 2px solid #95a5a6;
      }

      .demo-cell:hover {
        transform: scale(1.05);
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
      }

      .demo-cell-number {
        position: absolute;
        top: 3px;
        left: 3px;
        font-size: 0.7rem;
        color: rgba(0, 0, 0, 0.6);
      }

      .demo-cell-content {
        font-size: 1.8rem;
      }

      .demo-status {
        color: rgba(255, 255, 255, 0.9);
        margin: 15px 0;
        font-weight: bold;
        min-height: 24px;
      }

      .demo-cycle {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 15px;
      }

      .cycle-step {
        background: rgba(255, 255, 255, 0.1);
        padding: 8px 15px;
        border-radius: 5px;
        color: white;
        font-size: 0.9rem;
        min-width: 90px;
        text-align: center;
      }

      .cycle-arrow {
        color: #3498db;
        font-weight: bold;
      }

      /* –£–ª—É—á—à–µ–Ω–Ω—ã–π –±–ª–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ */
      .controls-explanation {
        margin: 25px 0;
      }

      .control-explanation-item {
        display: flex;
        align-items: flex-start;
        gap: 20px;
        margin-bottom: 25px;
        background: rgba(255, 255, 255, 0.03);
        padding: 15px;
        border-radius: 8px;
        border-left: 3px solid #3498db;
      }

      .control-explanation-item .demo-btn {
        min-width: 160px;
        flex-shrink: 0;
      }

      .explanation-text {
        flex: 1;
      }

      .explanation-text strong {
        color: white;
        font-size: 1.1rem;
        display: block;
        margin-bottom: 8px;
      }

      .explanation-text p {
        color: rgba(255, 255, 255, 0.8);
        margin: 5px 0;
        line-height: 1.5;
        font-size: 0.95rem;
      }

      /* –ú–∏–Ω–∏-—Ç–∞–∫—Ç–∏–∫–∏ */
      .tactics-grid-mini {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 25px 0;
      }

      .tactic-card-mini {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        padding: 15px;
        display: flex;
        align-items: center;
        gap: 15px;
        transition: all 0.3s ease;
        cursor: pointer;
        border-top: 4px solid transparent;
      }

      .tactic-card-mini:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-2px);
      }

      .tactic-card-mini.gold {
        border-top-color: #ffd700;
      }

      .tactic-card-mini.silver {
        border-top-color: #bdc3c7;
      }

      .tactic-card-mini.bronze {
        border-top-color: #cd7f32;
      }

      .tactic-rank {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
        font-size: 1.1rem;
        flex-shrink: 0;
      }

      .tactic-info {
        flex: 1;
      }

      .tactic-title {
        color: white;
        font-weight: bold;
        font-size: 1rem;
        margin-bottom: 4px;
      }

      .tactic-desc {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.85rem;
        line-height: 1.4;
      }

      .tactics-note {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.9rem;
        text-align: center;
        margin-top: 20px;
        font-style: italic;
      }

      /* –ë–ª–æ–∫ —Å –±–∞–≥–∞–º–∏ */
      .bug-report-section {
        background: rgba(231, 76, 60, 0.08);
        border: 1px solid rgba(231, 76, 60, 0.3);
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }

      .bug-report-section h4 {
        color: white;
        margin-bottom: 15px;
        font-size: 1.1rem;
      }

      .bug-steps {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin: 20px 0;
      }

      .bug-step {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .step-number {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background: #e74c3c;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        flex-shrink: 0;
      }

      .step-text {
        color: rgba(255, 255, 255, 0.9);
        flex: 1;
      }

      .contact-section {
        margin-top: 25px;
        text-align: center;
      }

      /* –§—É—Ç–µ—Ä –º–æ–¥–∞–ª–∫–∏ */
      .first-launch-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 30px;
        background: rgba(0, 0, 0, 0.2);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .footer-buttons {
        display: flex;
        gap: 10px;
      }

      .hint {
        color: rgba(255, 255, 255, 0.6);
        font-size: 0.85rem;
        margin-top: 5px;
        font-style: italic;
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
      @media (max-width: 768px) {
        .control-explanation-item {
          flex-direction: column;
          gap: 15px;
        }

        .control-explanation-item .demo-btn {
          min-width: 100%;
        }

        .tactics-grid-mini {
          grid-template-columns: 1fr;
        }

        .first-launch-footer {
          flex-wrap: wrap;
          gap: 15px;
          justify-content: center;
          padding: 10px;
          min-height: 80px;
        }

        .footer-buttons {
          order: -1;
          width: 100%;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>–ü–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∏–≥—Ä—ã "–°–Ω–µ–≥–æ–≤–∏–∫"</h1>
        <p class="subtitle">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è. –ü–æ–º–æ—â–Ω–∏–∫ –Ω–µ —É–º–µ–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å.</p>
        <p class="subtitle">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∞–∫—Ç–∏–∫–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏!</p>
      </header>

      <div class="game-area">
        <!-- –ò–≥—Ä–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="game-info">
          <div class="info-item">
            <div class="info-value" id="gold-count">0</div>
            <div class="info-label">–ó–æ–ª–æ—Ç—ã—Ö</div>
          </div>
          <div class="info-item">
            <div class="info-value" id="empty-count">0</div>
            <div class="info-label">–ü—É—Å—Ç—ã—Ö</div>
          </div>
          <div class="info-item">
            <div class="info-value" id="possible-gold-count">0</div>
            <div class="info-label">–í–æ–∑–º–æ–∂–Ω—ã—Ö ‚â•50%</div>
          </div>
          <div class="info-item">
            <div class="info-value" id="next-move-cell">--</div>
            <div class="info-label">–°–ª–µ–¥—É—é—â–∏–π —Ö–æ–¥</div>
          </div>
        </div>

        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º/–∏–º–ø–æ—Ä—Ç–æ–º -->
        <div class="top-controls">
          <div class="export-import">
            <button class="btn btn-secondary" id="export-btn" title="–≠–∫—Å–ø–æ—Ä—Ç/–ò–º–ø–æ—Ä—Ç –ø–æ–ª—è">–≠–∫—Å–ø–æ—Ä—Ç / –ò–º–ø–æ—Ä—Ç</button>
          </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
        <div class="game-board" id="game-board"></div>

        <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –∫–Ω–æ–ø–∫–∞–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="bottom-controls">
          <div class="left-controls">
            <button class="btn btn-primary btn-with-text" id="new-game-btn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
          </div>
          <div class="right-controls">
            <button class="btn btn-outline-mode btn-with-text" id="outline-mode-btn">–ó–æ–ª–æ—Ç—ã–µ –∫–æ–Ω—Ç—É—Ä—ã</button>
            <button class="btn btn-next-move" id="next-move-btn" title="–ü–æ–¥—Å–∫–∞–∑–∫–∞ —Ö–æ–¥–∞">üí°</button>
          </div>
        </div>
      </div>

      <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
      <div class="instructions">
        <h3>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–º–æ—â–Ω–∏–∫:</h3>
        <ul>
          <li>
            –ù–∞–∂–∏–º–∞–π—Ç–µ –Ω–∞ –∫–ª–µ—Ç–∫–∏, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å: <strong>–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ ‚Üí –û–±—ã—á–Ω–∞—è ‚Üí –ó–æ–ª–æ—Ç–∞—è ‚Üí –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</strong>
          </li>
          <li><strong>–ö–Ω–æ–ø–∫–∞ "–ó–æ–ª–æ—Ç—ã–µ –∫–æ–Ω—Ç—É—Ä—ã":</strong> —Ä–µ–∂–∏–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏/—Å–Ω—è—Ç–∏—è –∑–æ–ª–æ—Ç—ã—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤</li>
          <li><strong>–ö–Ω–æ–ø–∫–∞ "üí°":</strong> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–π —Å–ª–µ–¥—É—é—â–∏–π —Ö–æ–¥ (–≤–∫–ª—é—á–∞–µ—Ç—Å—è/–≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è)</li>
          <li><strong>–ö–Ω–æ–ø–∫–∏ "üì§" –∏ "üì•":</strong> —ç–∫—Å–ø–æ—Ä—Ç –∏ –∏–º–ø–æ—Ä—Ç —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–ª—è</li>
          <li><strong>–ü—Ä–æ—Ü–µ–Ω—Ç—ã –≤ –∫–ª–µ—Ç–∫–∞—Ö:</strong> —à–∞–Ω—Å –±—ã—Ç—å –∑–æ–ª–æ—Ç–æ–π —è—á–µ–π–∫–æ–π</li>
          <li><strong>–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</strong> –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –≤–∞—à–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è</li>
        </ul>

        <div class="legend">
          <div class="legend-item">
            <div class="legend-color" style="background-color: #bdc3c7"></div>
            <span>–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #ecf0f1"></div>
            <span>–û–±—ã—á–Ω–∞—è</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #ffd700"></div>
            <span>–ó–æ–ª–æ—Ç–∞—è</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #7f8c8d"></div>
            <span>–ü—É—Å—Ç–∞—è</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="border: 2px solid #ffa500; background-color: #ecf0f1"></div>
            <span>–ó–æ–ª–æ—Ç–æ–π –∫–æ–Ω—Ç—É—Ä</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #27ae60; border: 2px solid #2c3e50"></div>
            <span>–°–ª–µ–¥—É—é—â–∏–π —Ö–æ–¥</span>
          </div>
        </div>
      </div>

      <!-- –°–µ–∫—Ü–∏—è —Å –ª—É—á—à–∏–º–∏ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ —Ç–∞–∫—Ç–∏–∫–∞–º–∏ -->
      <div class="tactics-section">
        <h3 class="section-title">üèÜ –¢–æ–ø-3 –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Ç–∞–∫—Ç–∏–∫</h3>
        <div class="tactics-grid">
          <div class="tactic-card gold" data-tactic="diamond">
            <h4><span class="rank">1</span> –ê–ª–º–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
            <div class="tactic-preview" id="diamond-preview">
              <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω JavaScript -->
            </div>
            <div class="tactic-description">
              –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π —Ä–æ–º–± –≤ —Ü–µ–Ω—Ç—Ä–µ –ø–æ–ª—è. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ö–≤–∞—Ç (16 —Å–æ—Å–µ–¥–µ–π), –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏–∏.
            </div>
          </div>
          <div class="tactic-card silver" data-tactic="cross">
            <h4><span class="rank">2</span> –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä–µ—Å—Ç</h4>
            <div class="tactic-preview" id="cross-preview">
              <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω JavaScript -->
            </div>
            <div class="tactic-description">
              –°–º–µ—â–µ–Ω–Ω—ã–π –∫—Ä–µ—Å—Ç —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö. –û—Ç–ª–∏—á–Ω–æ –≤—ã—è–≤–ª—è–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã –∑–æ–ª–æ—Ç–∞.
            </div>
          </div>
          <div class="tactic-card bronze" data-tactic="diagonal">
            <h4><span class="rank">3</span> –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —Å–∫–∞–Ω–µ—Ä</h4>
            <div class="tactic-preview" id="diagonal-preview">
              <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω JavaScript -->
            </div>
            <div class="tactic-description">
              –î–∏–∞–≥–æ–Ω–∞–ª—å —á–µ—Ä–µ–∑ –≤—Å—ë –ø–æ–ª–µ. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –∑–æ–ª–æ—Ç—ã—Ö —è—á–µ–µ–∫.
            </div>
          </div>
        </div>
      </div>

      <!-- –°–µ–∫—Ü–∏—è —Å —Å–æ–≤–µ—Ç–∞–º–∏ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ -->
      <div class="tactics-section">
        <h3 class="section-title">üìö –°–æ–≤–µ—Ç—ã –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤</h3>
        <div class="tactics-grid">
          <div class="tactic-card blue" data-tactic="triangulation">
            <h4>–¢—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏—è</h4>
            <div class="tactic-preview" id="triangulation-preview">
              <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω JavaScript -->
            </div>
            <div class="tactic-description">
              –ï—Å–ª–∏ –¥–≤–µ –∫–ª–µ—Ç–∫–∏ —Å –∑–æ–ª–æ—Ç—ã–º–∏ –∫–æ–Ω—Ç—É—Ä–∞–º–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –æ–¥–Ω—É –∫–ª–µ—Ç–∫—É ‚Äî —Ç–∞–º –ø–æ—á—Ç–∏ —Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–æ.
            </div>
          </div>
          <div class="tactic-card blue" data-tactic="exclusion">
            <h4>–ú–µ—Ç–æ–¥ –∏—Å–∫–ª—é—á–µ–Ω–∏—è</h4>
            <div class="tactic-preview" id="exclusion-preview">
              <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω JavaScript -->
            </div>
            <div class="tactic-description">
              –ö–ª–µ—Ç–∫–∏ —Å —Å–µ—Ä—ã–º–∏/–∫—Ä–∞—Å–Ω—ã–º–∏ —Ä–∞–º–∫–∞–º–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –≥–¥–µ –ù–ï –∏—Å–∫–∞—Ç—å. –≠–∫–æ–Ω–æ–º—å—Ç–µ —Ö–æ–¥—ã!
            </div>
          </div>
          <div class="tactic-card blue" data-tactic="avoid-corners">
            <h4>–ò–∑–±–µ–≥–∞–π—Ç–µ —É–≥–ª–æ–≤</h4>
            <div class="tactic-preview" id="corners-preview">
              <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω JavaScript -->
            </div>
            <div class="tactic-description">
              –£–≥–ª—ã –¥–∞—é—Ç –º–∞–ª–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (2-3 —Å–æ—Å–µ–¥–∞). –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫ (4 —Å–æ—Å–µ–¥–∞).
            </div>
          </div>
        </div>
      </div>
      <p class="author-note">
        <a href="https://github.com/CrossCanon/snowman_scx" target="_blank" rel="noopener noreferrer">GitHub</a> /
        <a href="https://vk.com/crosscanon" target="_blank" rel="noopener noreferrer">VK</a> /
        <a href="https://www.donationalerts.com/r/crosscanon" target="_blank" rel="noopener noreferrer">Donation </a>
      </p>
      <p class="author-note">–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è. –°–¥–µ–ª–∞–Ω CrossCanon</p>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ -->
    <div class="first-launch-modal-overlay" id="first-launch-modal">
      <div class="first-launch-modal">
        <div class="first-launch-header">
          <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∏–≥—Ä—ã "–°–Ω–µ–≥–æ–≤–∏–∫"</h2>
          <button class="first-launch-close" id="first-launch-close">√ó</button>
        </div>

        <div class="first-launch-content">
          <!-- –®–∞–≥ 1: –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è -->
          <div class="tutorial-step active" data-step="1">
            <div class="step-icon">üìã</div>
            <h3>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–º–æ—â–Ω–∏–∫–æ–º</h3>
            <p>
              –≠—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª—è –≤ –∏–≥—Ä–µ "–°–Ω–µ–≥–æ–≤–∏–∫". –í–≤–æ–¥–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è, –∞ –ø–æ–º–æ—â–Ω–∏–∫
              –ø–æ–¥—Å–∫–∞–∂–µ—Ç –ª—É—á—à–∏–µ —Ö–æ–¥—ã.
            </p>

            <div class="interactive-demo">
              <div class="demo-instruction">–ö–ª–∏–∫–∞–π—Ç–µ –ø–æ —è—á–µ–π–∫–µ —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –µ—ë —Å—Ç–∞—Ç—É—Å:</div>
              <div class="demo-cell-container">
                <div class="demo-cell" id="demo-cell">
                  <div class="demo-cell-number">2,3</div>
                  <div class="demo-cell-content" id="demo-cell-content">?</div>
                </div>
              </div>
              <div class="demo-status" id="demo-status">–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</div>
              <div class="demo-cycle">
                <div class="cycle-step">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</div>
                <div class="cycle-arrow">‚Üí</div>
                <div class="cycle-step">–û–±—ã—á–Ω–∞—è</div>
                <div class="cycle-arrow">‚Üí</div>
                <div class="cycle-step">–ó–æ–ª–æ—Ç–∞—è</div>
                <div class="cycle-arrow">‚Üí</div>
                <div class="cycle-step">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</div>
              </div>
            </div>
          </div>

          <!-- –®–∞–≥ 2: –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
          <div class="tutorial-step" data-step="2">
            <h3>–ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Ä–µ–∂–∏–º—ã</h3>

            <div class="controls-explanation">
              <div class="control-explanation-item">
                <button class="demo-btn btn-primary">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <div class="explanation-text">
                  <strong>–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –ø–æ–ª—è</strong>
                </div>
              </div>

              <div class="control-explanation-item">
                <button class="demo-btn btn-outline-mode">–ó–æ–ª–æ—Ç—ã–µ –∫–æ–Ω—Ç—É—Ä—ã</button>
                <div class="explanation-text">
                  <strong>–†–µ–∂–∏–º –∑–æ–ª–æ—Ç—ã—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤</strong>
                  <p>
                    –í —Ä–µ–∂–∏–º–µ –∫–ª–∏–∫ –ø–æ —è—á–µ–π–∫–µ - —Å—Ç–∞–≤–∏—Ç/—É–±–∏—Ä–∞–µ—Ç –∑–æ–ª–æ—Ç–æ–π –∫–æ–Ω—Ç—É—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ä—è–¥–æ–º –µ—Å—Ç—å –∑–æ–ª–æ—Ç–æ.
                  </p>
                </div>
              </div>

              <div class="control-explanation-item">
                <button class="demo-btn btn-next-move">üí°</button>
                <div class="explanation-text">
                  <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ö–æ–¥–∞</strong>
                  <p>
                    –í–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Å–≤–µ—Ç–∫—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–π —è—á–µ–π–∫–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ö–æ–¥–∞. –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ª–µ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç
                    –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.
                  </p>
                </div>
              </div>

              <div class="control-explanation-item">
                <button class="demo-btn btn-secondary">–≠–∫—Å–ø–æ—Ä—Ç / –ò–º–ø–æ—Ä—Ç</button>
                <div class="explanation-text">
                  <strong>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞</strong>
                  <p>–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—è–º–∏ –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –∏–≥—Ä—ã –ø–æ–∑–∂–µ.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- –®–∞–≥ 3: –¢–∞–∫—Ç–∏–∫–∏ -->
          <div class="tutorial-step" data-step="3">
            <div class="step-icon">üìä</div>
            <h3>–ì–æ—Ç–æ–≤—ã–µ —Ç–∞–∫—Ç–∏–∫–∏</h3>
            <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã:</p>

            <div class="tactics-grid-mini">
              <div class="tactic-card-mini gold" data-tactic="diamond">
                <div class="tactic-rank">1</div>
                <div class="tactic-info">
                  <div class="tactic-title">–ê–ª–º–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                  <div class="tactic-desc">–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –ø–æ–ª—è 5√ó6</div>
                </div>
              </div>
              <div class="tactic-card-mini silver" data-tactic="cross">
                <div class="tactic-rank">2</div>
                <div class="tactic-info">
                  <div class="tactic-title">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä–µ—Å—Ç</div>
                  <div class="tactic-desc">–î–ª—è –ø–æ–∏—Å–∫–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤</div>
                </div>
              </div>
              <div class="tactic-card-mini bronze" data-tactic="diagonal">
                <div class="tactic-rank">3</div>
                <div class="tactic-info">
                  <div class="tactic-title">–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —Å–∫–∞–Ω–µ—Ä</div>
                  <div class="tactic-desc">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–π</div>
                </div>
              </div>
            </div>

            <p class="tactics-note">
              –ö–ª–∏–∫–∞–π—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–∞–∫—Ç–∏–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π.
            </p>
          </div>

          <!-- –®–∞–≥ 4: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –±–∞–≥–∏ -->
          <div class="tutorial-step" data-step="4">
            <h3>–°–∞–π—Ç –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h3>

            <div class="dev-notice">
              <p>–ü–æ–º–æ—â–Ω–∏–∫ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–ª—É—á—à–∞–µ—Ç—Å—è. –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è, –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.</p>

              <div class="bug-report-section">
                <h4>–ù–∞—à–ª–∏ –ø—Ä–æ–±–ª–µ–º—É –∏–ª–∏ —Å—Ç—Ä–∞–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ?</h4>
                <div class="bug-steps">
                  <div class="bug-step">
                    <div class="step-number">1</div>
                    <div class="step-text">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <strong>"–≠–∫—Å–ø–æ—Ä—Ç / –ò–º–ø–æ—Ä—Ç"</strong></div>
                  </div>
                  <div class="bug-step">
                    <div class="step-number">2</div>
                    <div class="step-text">–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—è</div>
                  </div>
                  <div class="bug-step">
                    <div class="step-number">3</div>
                    <div class="step-text">–û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –º–Ω–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã</div>
                  </div>
                </div>

                <div class="contact-section">
                  <div class="contact-links">
                    <a href="https://vk.com/crosscanon" target="_blank" class="contact-link vk">VK</a>
                    <a href="https://github.com/CrossCanon/snowman_scx" target="_blank" class="contact-link github"
                      >GitHub</a
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="first-launch-footer">
          <div class="dont-show-again">
            <label>
              <input type="checkbox" id="dont-show-again" />
              –ë–æ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å
            </label>
          </div>
          <div class="step-indicators">
            <span class="step-dot active" data-step="1"></span>
            <span class="step-dot" data-step="2"></span>
            <span class="step-dot" data-step="3"></span>
            <span class="step-dot" data-step="4"></span>
          </div>
          <div class="footer-buttons">
            <button class="btn btn-primary" id="next-step">–î–∞–ª–µ–µ</button>
          </div>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ç–∞–∫—Ç–∏–∫ -->
    <div class="modal-overlay" id="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <h3 class="modal-title" id="modal-title">
            <span class="rank" id="modal-rank">1</span>
            <span id="modal-title-text">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫–∏</span>
          </h3>
          <button class="close-modal" id="close-modal">&times;</button>
        </div>
        <div class="modal-content" id="modal-content">
          <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞ -->
    <div class="export-import-modal" id="export-import-modal">
      <div class="modal-header">
        <h3 class="modal-title">–≠–∫—Å–ø–æ—Ä—Ç / –ò–º–ø–æ—Ä—Ç –ø–æ–ª—è</h3>
        <button class="close-modal" id="close-export-modal">&times;</button>
      </div>
      <div class="modal-content">
        <div id="export-container">
          <p>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏:</p>
          <div class="code-container">
            <div class="code-content">
              <code id="export-code"></code>
            </div>
            <button class="copy-btn" id="copy-btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
          <p><small>–§–æ—Ä–º–∞—Ç: A1g,B2o,C3u –≥–¥–µ g=gold, o=outline, u=unknown, n=normal, e=empty</small></p>
        </div>
        <div id="import-container">
          <p>–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∏:</p>
          <input type="text" class="import-input" id="import-input" placeholder="A1g,B2o,C3u..." />
          <button class="btn btn-primary" id="load-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
          <div class="import-status" id="import-status"></div>
        </div>
      </div>
    </div>
    <div class="export-import-overlay" id="export-import-overlay"></div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const rows = 5;
        const cols = 6;
        const totalGold = 4;
        let gameBoard = [];
        let emptyCells = [];
        let possibleGoldCells = [];
        let outlineMode = false;
        let nextMoveMode = false;
        let nextMoveHintCell = null;

        // –ê–ª–º–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞—Ü–∏—è - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ä—Ç
        const DIAMOND_FORMATION = [
          { row: 1, col: 1 }, // (2,2)
          { row: 1, col: 4 }, // (2,5)
          { row: 3, col: 1 }, // (4,2)
          { row: 3, col: 4 }, // (4,5)
        ];

        const gameBoardElement = document.getElementById("game-board");
        const goldCountElement = document.getElementById("gold-count");
        const emptyCountElement = document.getElementById("empty-count");
        const possibleGoldCountElement = document.getElementById("possible-gold-count");
        const nextMoveCellElement = document.getElementById("next-move-cell");
        const newGameBtn = document.getElementById("new-game-btn");
        const outlineModeBtn = document.getElementById("outline-mode-btn");
        const nextMoveBtn = document.getElementById("next-move-btn");
        const exportBtn = document.getElementById("export-btn");
        const exportImportModal = document.getElementById("export-import-modal");
        const exportImportOverlay = document.getElementById("export-import-overlay");
        const exportCodeElement = document.getElementById("export-code");
        const copyBtn = document.getElementById("copy-btn");
        const importInput = document.getElementById("import-input");
        const loadBtn = document.getElementById("load-btn");
        const importStatus = document.getElementById("import-status");
        const closeExportModal = document.getElementById("close-export-modal");

        // –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        const modalOverlay = document.getElementById("modal-overlay");
        const modalTitle = document.getElementById("modal-title-text");
        const modalRank = document.getElementById("modal-rank");
        const modalContent = document.getElementById("modal-content");
        const closeModalBtn = document.getElementById("close-modal");

        // –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–µ—Ç–æ–∫
        const CELL_STATES = {
          UNKNOWN: "unknown",
          NORMAL: "normal",
          GOLD: "gold",
          EMPTY: "empty",
          POSSIBLE_GOLD: "possible-gold",
        };

        // –ö–æ–¥—ã –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
        const CELL_CODES = {
          unknown: "u",
          normal: "n",
          gold: "g",
          empty: "e",
          outline: "o",
        };

        const CODE_CELLS = {
          u: CELL_STATES.UNKNOWN,
          n: CELL_STATES.NORMAL,
          g: CELL_STATES.GOLD,
          e: CELL_STATES.EMPTY,
          o: CELL_STATES.UNKNOWN,
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        function initGameBoard() {
          // 1. –ë—ã—Å—Ç—Ä—ã–π —Å–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
          gameBoard = [];
          emptyCells = [];
          possibleGoldCells = [];
          outlineMode = false;
          nextMoveMode = false;
          nextMoveHintCell = null;

          // 2. –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –±—ã—Å—Ç—Ä–æ
          for (let row = 0; row < rows; row++) {
            gameBoard[row] = new Array(cols);
            for (let col = 0; col < cols; col++) {
              gameBoard[row][col] = {
                state: CELL_STATES.UNKNOWN,
                hasGoldOutline: false,
                goldChance: 0,
                row: row,
                col: col,
                isRecommended: false,
                infoValue: 0,
              };
            }
          }

          // 3. –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (–±–µ–∑ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤)
          renderGameBoardFast();

          // 4. –¢—è–∂–µ–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è - –ø–æ—Å–ª–µ
          requestIdleCallback(
            () => {
              analyzeBoard();
              updateCounters();
              if (nextMoveMode) updateNextMoveHint();
              // –ü–æ–ª–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏
              renderGameBoardFull();
            },
            { timeout: 500 }
          );

          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä—ã —Ç–∞–∫—Ç–∏–∫
          initTacticPreviews();

          // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
          setupTacticCards();
        }

        function renderGameBoardFast() {
          // –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
          const fragment = document.createDocumentFragment();

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];
              const cellElement = document.createElement("div");

              // –¢–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
              let cellClass = `cell ${cell.state}`;
              if (cell.hasGoldOutline) cellClass += " gold-outline";
              if (nextMoveMode && cell.isRecommended) cellClass += " next-move-hint";

              cellElement.className = cellClass;
              cellElement.textContent = cell.state === CELL_STATES.GOLD ? "‚òÖ" : "";

              // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
              const cellNumber = document.createElement("div");
              cellNumber.className = "cell-number";
              cellNumber.textContent = `${row + 1},${col + 1}`;
              cellElement.appendChild(cellNumber);

              // –ù–ï–¢ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ!

              cellElement.addEventListener("click", () => handleCellClick(row, col));
              fragment.appendChild(cellElement);
            }
          }

          gameBoardElement.innerHTML = "";
          gameBoardElement.appendChild(fragment);
        }

        function renderGameBoardFull() {
          // –ü–æ–ª–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏ (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–∑–∂–µ)
          const cells = gameBoardElement.children;

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];
              const cellElement = cells[row * cols + col];

              // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
              if (cell.goldChance > 0 && cell.state === CELL_STATES.UNKNOWN) {
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã
                const oldChance = cellElement.querySelector(".gold-chance");
                if (oldChance) oldChance.remove();

                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ
                const chanceElement = document.createElement("div");
                chanceElement.className = "gold-chance";
                chanceElement.classList.add(cell.goldChance >= 50 ? "high" : "low");
                chanceElement.textContent = `${Math.round(cell.goldChance)}%`;
                cellElement.appendChild(chanceElement);
              } else {
                // –£–±–∏—Ä–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω—ã
                const oldChance = cellElement.querySelector(".gold-chance");
                if (oldChance) oldChance.remove();
              }
            }
          }
        }

        // const devBanner = document.getElementById('dev-banner');
        // const closeBtn = document.getElementById('dev-banner-close');

        // // –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage, –±—ã–ª –ª–∏ –±–∞–Ω–Ω–µ—Ä —É–∂–µ –∑–∞–∫—Ä—ã—Ç
        // const bannerClosed = localStorage.getItem('devBannerClosed');

        // if (!bannerClosed) {
        // 	// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä
        // 	devBanner.classList.add('active');
        // 	document.body.classList.add('has-dev-banner');

        // 	// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è
        // 	closeBtn.addEventListener('click', function() {
        // 		devBanner.classList.remove('active');
        // 		document.body.classList.remove('has-dev-banner');
        // 		localStorage.setItem('devBannerClosed', 'true');
        // 	});
        // }

        // –£–õ–£–ß–®–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–û–î–°–ö–ê–ó–ö–ò –° –†–ê–¶–ò–û–ù–ê–õ–¨–ù–û–ô –õ–û–ì–ò–ö–û–ô
        function calculateNextMove() {
          let bestCell = null;
          let bestScore = -Infinity;

          // –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: –ü–æ–ª—É—á–∞–µ–º –æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–∏–Ω —Ä–∞–∑
          const totalCells = rows * cols;
          const unknownCount = countUnknownCells();
          const unknownPercentage = (unknownCount / totalCells) * 100;

          // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —Å—Ç–æ–∏—Ç –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–Ω—É—Å –∑–∞ –∞–ª–º–∞–∑–Ω—É—é —Ñ–æ—Ä–º–∞—Ü–∏—é
          const useDiamondBonus = shouldContinueFormation(DIAMOND_FORMATION);

          // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Ñ–ª–∞–≥–∏
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              gameBoard[row][col].isRecommended = false;
              gameBoard[row][col].infoValue = 0;
            }
          }

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–û–ï –ó–û–õ–û–¢–û (100% —à–∞–Ω—Å)
          // ------------------------------------------------------------
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];
              if (cell.state !== CELL_STATES.UNKNOWN) continue;
              if (emptyCells.some((ec) => ec.row === row && ec.col === col)) continue;

              // –ö–ª–µ—Ç–∫–∏ —Å 95-100% —à–∞–Ω—Å–æ–º (—Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏—è –∏–ª–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–æ–ª–æ—Ç–æ)
              if (cell.goldChance >= 95) {
                // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç - —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
                return { row, col, score: 1000 };
              }
            }
          }

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 2: –û–ß–ï–ù–¨ –í–´–°–û–ö–ò–ô –®–ê–ù–° (>80%)
          // ------------------------------------------------------------
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];
              if (cell.state !== CELL_STATES.UNKNOWN) continue;
              if (emptyCells.some((ec) => ec.row === row && ec.col === col)) continue;

              if (cell.goldChance >= 80) {
                const score = 500 + cell.goldChance; // 580-599
                if (score > bestScore) {
                  bestScore = score;
                  bestCell = { row, col, score };
                }
              }
            }
          }

          if (bestCell) return bestCell;

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 3: –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –ó–û–õ–û–¢–û (–ª–æ–≥–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥)
          // ------------------------------------------------------------
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –∫–æ–Ω—Ç—É—Ä—ã - –µ—Å–ª–∏ —É –∫–æ–Ω—Ç—É—Ä–∞ –æ—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–æ—Å–µ–¥
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              if (gameBoard[row][col].hasGoldOutline) {
                const neighbors = getAdjacentCells(row, col);

                let goldCount = 0;
                let unknownNeighbors = [];

                neighbors.forEach((neighbor) => {
                  const cell = gameBoard[neighbor.row][neighbor.col];
                  if (cell.state === CELL_STATES.GOLD) {
                    goldCount++;
                  } else if (
                    cell.state === CELL_STATES.UNKNOWN &&
                    !emptyCells.some((ec) => ec.row === neighbor.row && ec.col === neighbor.col)
                  ) {
                    unknownNeighbors.push(neighbor);
                  }
                });

                // –ï—Å–ª–∏ —É –∫–æ–Ω—Ç—É—Ä–∞ –µ—â–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∑–æ–ª–æ—Ç–æ –∏ –æ—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–æ—Å–µ–¥
                if (goldCount === 0 && unknownNeighbors.length === 1) {
                  const forcedGold = unknownNeighbors[0];
                  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —á—É—Ç—å –Ω–∏–∂–µ 100% —à–∞–Ω—Å–∞, –Ω–æ –≤—ã—à–µ –æ–±—ã—á–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫
                  const score = 450;
                  if (score > bestScore) {
                    bestScore = score;
                    bestCell = { row: forcedGold.row, col: forcedGold.col, score };
                  }
                }
              }
            }
          }

          if (bestCell) return bestCell;

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 4: –ö–õ–ï–¢–ö–ò –ú–ï–ñ–î–£ –î–í–£–ú–Ø –ö–û–ù–¢–£–†–ê–ú–ò (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏—è)
          // ------------------------------------------------------------
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];
              if (cell.state !== CELL_STATES.UNKNOWN) continue;
              if (emptyCells.some((ec) => ec.row === row && ec.col === col)) continue;

              // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç—É—Ä–æ–≤ –≤–æ–∫—Ä—É–≥
              const neighbors = getAdjacentCells(row, col);
              let outlineCount = 0;

              neighbors.forEach((neighbor) => {
                if (gameBoard[neighbor.row][neighbor.col].hasGoldOutline) {
                  outlineCount++;
                }
              });

              if (outlineCount >= 2) {
                // –≠—Ç–æ –∫–ª–µ—Ç–∫–∞ –º–µ–∂–¥—É –∫–æ–Ω—Ç—É—Ä–∞–º–∏ - –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–æ–ª–æ—Ç–∞
                const score = 400 + calculateInformationValue(row, col, useDiamondBonus);
                if (score > bestScore) {
                  bestScore = score;
                  bestCell = { row, col, score };
                }
              }
            }
          }

          if (bestCell) return bestCell;

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 5: –ù–ê–ß–ê–õ–û –ò–ì–†–´ - –ê–õ–ú–ê–ó–ù–ê–Ø –§–û–†–ú–ê–¶–ò–Ø
          // ------------------------------------------------------------
          if (unknownCount === totalCells) {
            // –°–∞–º–∞—è –ø–µ—Ä–≤–∞—è –∏–≥—Ä–∞ - –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø–µ—Ä–≤—É—é –∫–ª–µ—Ç–∫—É –∞–ª–º–∞–∑–Ω–æ–π —Ñ–æ—Ä–º–∞—Ü–∏–∏
            bestCell = { row: DIAMOND_FORMATION[0].row, col: DIAMOND_FORMATION[0].col, score: 100 };
            return bestCell;
          }

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 6: –ó–ê–í–ï–†–®–ï–ù–ò–ï –ê–õ–ú–ê–ó–ù–û–ô –§–û–†–ú–ê–¶–ò–ò (–µ—Å–ª–∏ –Ω–∞—á–∞–ª–∏)
          // ------------------------------------------------------------
          let startedDiamondFormation = 0;
          for (const pos of DIAMOND_FORMATION) {
            const cell = gameBoard[pos.row][pos.col];
            if (cell.state !== CELL_STATES.UNKNOWN || cell.hasGoldOutline) {
              startedDiamondFormation++;
            }
          }

          // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∞–ª–º–∞–∑–Ω—É—é —Ñ–æ—Ä–º–∞—Ü–∏—é –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —É–∂–µ –Ω–∞—á–∞–ª–∏ –µ—ë
          if (startedDiamondFormation > 0) {
            let unfinishedDiamondCells = [];
            for (const pos of DIAMOND_FORMATION) {
              const cell = gameBoard[pos.row][pos.col];
              if ((cell.state === CELL_STATES.UNKNOWN && !cell.hasGoldOutline) || cell.hasGoldOutline) {
                if (!emptyCells.some((ec) => ec.row === pos.row && ec.col === pos.col)) {
                  unfinishedDiamondCells.push(pos);
                }
              }
            }

            // –í—ã–±–∏—Ä–∞–µ–º –ª—É—á—à—É—é –∫–ª–µ—Ç–∫—É –∏–∑ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö
            if (unfinishedDiamondCells.length > 0) {
              let bestDiamondCell = null;
              let bestDiamondScore = -Infinity;

              for (const pos of unfinishedDiamondCells) {
                const cell = gameBoard[pos.row][pos.col];
                if (cell.state === CELL_STATES.NORMAL || cell.state === CELL_STATES.GOLD) {
                  continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º, –µ—Å–ª–∏ —É–∂–µ –æ–±—ã—á–Ω–∞—è –∏–ª–∏ –∑–æ–ª–æ—Ç–∞—è
                }

                const score = calculateInformationValue(pos.row, pos.col, useDiamondBonus);
                if (score > bestDiamondScore) {
                  bestDiamondScore = score;
                  bestDiamondCell = pos;
                }
              }

              if (bestDiamondCell && bestDiamondScore > 30) {
                const finalScore = 300 + bestDiamondScore;
                if (finalScore > bestScore) {
                  bestScore = finalScore;
                  bestCell = { row: bestDiamondCell.row, col: bestDiamondCell.col, score: finalScore };
                }
              }
            }
          }

          if (bestCell) return bestCell;

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 7: –ö–õ–ï–¢–ö–ò –†–Ø–î–û–ú –° –ö–û–ù–¢–£–†–ê–ú–ò (—É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–æ–ª–æ—Ç–∞)
          // ------------------------------------------------------------
          const outlineCells = [];
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              if (gameBoard[row][col].hasGoldOutline) {
                outlineCells.push({ row, col });
              }
            }
          }

          for (const outline of outlineCells) {
            const neighbors = getAdjacentCells(outline.row, outline.col);
            let unknownNeighbors = [];

            neighbors.forEach((neighbor) => {
              const cell = gameBoard[neighbor.row][neighbor.col];
              if (
                cell.state === CELL_STATES.UNKNOWN &&
                !emptyCells.some((ec) => ec.row === neighbor.row && ec.col === neighbor.col)
              ) {
                unknownNeighbors.push(neighbor);
              }
            });

            // –ï—Å–ª–∏ —É –∫–æ–Ω—Ç—É—Ä–∞ –µ—Å—Ç—å –Ω–µ–æ—Ç–∫—Ä—ã—Ç—ã–µ —Å–æ—Å–µ–¥–∏
            if (unknownNeighbors.length > 0) {
              // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–∫–æ–ª—å–∫–æ –∑–æ–ª–æ—Ç–∞ —É–∂–µ –Ω–∞–π–¥–µ–Ω–æ —É —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞
              let goldCount = 0;
              neighbors.forEach((neighbor) => {
                if (gameBoard[neighbor.row][neighbor.col].state === CELL_STATES.GOLD) {
                  goldCount++;
                }
              });

              // –ï—Å–ª–∏ —É –∫–æ–Ω—Ç—É—Ä–∞ —É–∂–µ –µ—Å—Ç—å –∑–æ–ª–æ—Ç–æ, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ù–ò–ó–ö–ò–ô
              if (goldCount > 0) {
                continue;
              }

              // –ï—Å–ª–∏ –∑–æ–ª–æ—Ç–∞ –Ω–µ—Ç, –≤—ã–±–∏—Ä–∞–µ–º –ª—É—á—à–µ–≥–æ —Å–æ—Å–µ–¥–∞
              let bestNeighbor = null;
              let bestNeighborScore = -Infinity;

              for (const neighbor of unknownNeighbors) {
                const score = calculateInformationValue(neighbor.row, neighbor.col, useDiamondBonus);
                if (score > bestNeighborScore) {
                  bestNeighborScore = score;
                  bestNeighbor = neighbor;
                }
              }

              if (bestNeighbor) {
                const finalScore = 200 + bestNeighborScore;
                if (finalScore > bestScore) {
                  bestScore = finalScore;
                  bestCell = { row: bestNeighbor.row, col: bestNeighbor.col, score: finalScore };
                }
              }
            }
          }

          if (bestCell) return bestCell;

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 8: –ü–†–ò–û–†–ò–¢–ï–¢ –¶–ï–ù–¢–†–ê–õ–¨–ù–´–• –ö–õ–ï–¢–û–ö (–µ—Å–ª–∏ –º–Ω–æ–≥–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö)
          // ------------------------------------------------------------
          if (unknownPercentage > 70) {
            for (let row = 0; row < rows; row++) {
              for (let col = 0; col < cols; col++) {
                const cell = gameBoard[row][col];
                if (cell.state !== CELL_STATES.UNKNOWN) continue;
                if (emptyCells.some((ec) => ec.row === row && ec.col === col)) continue;

                // –û—Å–æ–±—ã–π –±–æ–Ω—É—Å –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫ –ø—Ä–∏ –ø—É—Å—Ç–æ–º –ø–æ–ª–µ
                if (row >= 1 && row <= 3 && col >= 1 && col <= 4) {
                  const score = calculatePureInformationValue(row, col) + 100; // –ë–æ–Ω—É—Å
                  if (score > bestScore) {
                    bestScore = score;
                    bestCell = { row, col, score };
                  }
                }
              }
            }

            if (bestCell) return bestCell;
          }

          // ------------------------------------------------------------
          // –ü–†–ò–û–†–ò–¢–ï–¢ 9: –°–ê–ú–ê–Ø –ò–ù–§–û–†–ú–ê–¢–ò–í–ù–ê–Ø –ö–õ–ï–¢–ö–ê (–ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç)
          // ------------------------------------------------------------
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];
              if (cell.state !== CELL_STATES.UNKNOWN) continue;
              if (emptyCells.some((ec) => ec.row === row && ec.col === col)) continue;

              const infoValue = calculateInformationValue(row, col, useDiamondBonus);
              const score = infoValue;

              if (score > bestScore) {
                bestScore = score;
                bestCell = { row, col, score };
              }
            }
          }

          return bestCell;
        }

        // –†–∞—Å—á–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª–µ—Ç–∫–∏
        function calculateInformationValue(row, col, useDiamondBonus = false) {
          let infoValue = 0;
          const neighbors = getAdjacentCells(row, col);

          // 1. –°—á–∏—Ç–∞–µ–º –ù–û–í–£–Æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–æ—Å–µ–¥–∏)
          let newUnknownNeighbors = 0;
          neighbors.forEach((neighbor) => {
            const cell = gameBoard[neighbor.row][neighbor.col];
            // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ –ò –Ω–µ –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ –ø—É—Å—Ç–∞—è
            if (
              cell.state === CELL_STATES.UNKNOWN &&
              !emptyCells.some((ec) => ec.row === neighbor.row && ec.col === neighbor.col)
            ) {
              newUnknownNeighbors++;
            }
          });

          infoValue += newUnknownNeighbors * 25; // –ë–æ–ª—å—à–µ –æ—á–∫–æ–≤ –∑–∞ –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

          // 2. –ë–æ–Ω—É—Å –∑–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
          const neighborCount = neighbors.length;
          if (neighborCount === 4) infoValue += 20;
          else if (neighborCount === 3) infoValue += 10;
          else if (neighborCount === 2) infoValue -= 15; // –ë–æ–ª—å—à–∏–π —à—Ç—Ä–∞—Ñ –∑–∞ —É–≥–ª—ã

          // 3. –®—Ç—Ä–∞—Ñ –∑–∞ –∫–ª–µ—Ç–∫–∏ —Ä—è–¥–æ–º —Å —É–∂–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–º –∑–æ–ª–æ—Ç–æ–º
          let goldNeighbors = 0;
          neighbors.forEach((neighbor) => {
            if (gameBoard[neighbor.row][neighbor.col].state === CELL_STATES.GOLD) {
              goldNeighbors++;
            }
          });

          infoValue -= goldNeighbors * 30;

          // 4. –ë–æ–Ω—É—Å –∑–∞ –∫–ª–µ—Ç–∫–∏ —Ä—è–¥–æ–º —Å –∫–æ–Ω—Ç—É—Ä–∞–º–∏ (—É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–æ–ª–æ—Ç–∞)
          let outlineNeighborCount = 0;
          neighbors.forEach((neighbor) => {
            if (gameBoard[neighbor.row][neighbor.col].hasGoldOutline) {
              const outlineAdjacentCells = getAdjacentCells(neighbor.row, neighbor.col);
              let hasGold = false;
              outlineAdjacentCells.forEach((n) => {
                if (gameBoard[n.row][n.col].state === CELL_STATES.GOLD) {
                  hasGold = true;
                }
              });
              if (!hasGold) {
                outlineNeighborCount++;
              }
            }
          });

          infoValue += outlineNeighborCount * 12;

          // 5. –û–°–û–ë–´–ô –ë–û–ù–£–°: –µ—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –¥–∞—Å—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –í–ï–†–•–ù–ï–ô –ß–ê–°–¢–ò –ø–æ–ª—è
          // (–≤–µ—Ä—Ö–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ —á–∞—Å—Ç–æ –º–µ–Ω–µ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω—ã)
          if (row <= 1) {
            // –í–µ—Ä—Ö–Ω–∏–µ 2 —Å—Ç—Ä–æ–∫–∏
            infoValue += 25;
          }

          // 6. –®–¢–†–ê–§: –µ—Å–ª–∏ –º–Ω–æ–≥–∏–µ —Å–æ—Å–µ–¥–∏ —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã –∫–∞–∫ –ø—É—Å—Ç—ã–µ
          let knownEmptyNeighbors = 0;
          neighbors.forEach((neighbor) => {
            if (emptyCells.some((ec) => ec.row === neighbor.row && ec.col === neighbor.col)) {
              knownEmptyNeighbors++;
            }
          });

          infoValue -= knownEmptyNeighbors * 20; // –®—Ç—Ä–∞—Ñ –∑–∞ "–±–µ—Å–ø–æ–ª–µ–∑–Ω—ã—Ö" —Å–æ—Å–µ–¥–µ–π

          // 7. –ë–æ–Ω—É—Å –∑–∞ –∞–ª–º–∞–∑–Ω—É—é —Ñ–æ—Ä–º–∞—Ü–∏—é
          if (useDiamondBonus) {
            for (const pos of DIAMOND_FORMATION) {
              if (pos.row === row && pos.col === col) {
                infoValue += 30;
                break;
              }
            }
          }

          return infoValue;
        }

        function calculatePureInformationValue(row, col) {
          const neighbors = getAdjacentCells(row, col);

          // 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å–µ–¥–µ–π (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä)
          let score = neighbors.length * 20; // 20 –±–∞–ª–ª–æ–≤ –∑–∞ –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å–µ–¥–∞

          // 2. –ü–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª–µ
          if (neighbors.length === 4) score += 30; // –¶–µ–Ω—Ç—Ä - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å
          else if (neighbors.length === 3) score += 10; // –ö—Ä–∞–π
          else if (neighbors.length === 2) score -= 20; // –£–≥–æ–ª - —à—Ç—Ä–∞—Ñ

          // 3. –°–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö –∫–ª–µ—Ç–æ–∫ —É–∑–Ω–∞–µ–º
          let newInfo = 0;
          neighbors.forEach((neighbor) => {
            if (gameBoard[neighbor.row][neighbor.col].state === CELL_STATES.UNKNOWN) {
              newInfo++;
            }
          });
          score += newInfo * 15;

          // 4. –ë–æ–Ω—É—Å –∑–∞ –æ—Ç–¥–∞–ª–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç —É–∂–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∫–ª–µ—Ç–æ–∫
          // (—á—Ç–æ–±—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∑–æ–Ω—ã)
          let distanceFromKnown = 0;
          for (let r = 0; r < rows; r++) {
            for (let c = 0; c < cols; c++) {
              if (gameBoard[r][c].state !== CELL_STATES.UNKNOWN) {
                const distance = Math.abs(r - row) + Math.abs(c - col);
                distanceFromKnown += distance;
              }
            }
          }
          score += distanceFromKnown * 0.5;

          return score;
        }

        // –§–£–ù–ö–¶–ò–Ø: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å—Ç–æ–∏—Ç –ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ñ–æ—Ä–º–∞—Ü–∏—é
        function shouldContinueFormation(formationCells) {
          let formationOpened = 0;
          let otherNormalCells = 0;

          // –°—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ –∫–ª–µ—Ç–æ–∫ —Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ—Ç–∫—Ä—ã—Ç–æ –∫–∞–∫ NORMAL, GOLD –ò–õ–ò –∏–º–µ—é—Ç –∑–æ–ª–æ—Ç–æ–π –∫–æ–Ω—Ç—É—Ä
          for (const pos of formationCells) {
            const cell = gameBoard[pos.row][pos.col];
            if (cell.state === CELL_STATES.NORMAL || cell.state === CELL_STATES.GOLD || cell.hasGoldOutline) {
              formationOpened++;
            }
          }

          // –°—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ –î–†–£–ì–ò–• –∫–ª–µ—Ç–æ–∫ –æ—Ç–∫—Ä—ã—Ç–æ –∫–∞–∫ NORMAL, GOLD –∏–ª–∏ –∏–º–µ—é—Ç –∫–æ–Ω—Ç—É—Ä
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–ª–µ—Ç–∫–∏ —Ñ–æ—Ä–º–∞—Ü–∏–∏
              const isFormationCell = formationCells.some((pos) => pos.row === row && pos.col === col);

              if (!isFormationCell) {
                const cell = gameBoard[row][col];
                if (cell.state === CELL_STATES.NORMAL || cell.state === CELL_STATES.GOLD || cell.hasGoldOutline) {
                  otherNormalCells++;
                }
              }
            }
          }

          // –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –Ω–∞—á–∞—Ç–∞ (0 –∫–ª–µ—Ç–æ–∫) ‚Üí –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å
          if (formationOpened === 0) {
            return true;
          }

          // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ –¥—Ä—É–≥–∏—Ö –∫–ª–µ—Ç–æ–∫ ‚Üí –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è
          if (otherNormalCells > formationOpened * 1.5) {
            return false;
          }

          // –ï—Å–ª–∏ —É–∂–µ –Ω–∞—à–ª–∏ 3-4 –∫–ª–µ—Ç–∫–∏ —Ñ–æ—Ä–º–∞—Ü–∏–∏ ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å
          if (formationOpened >= 3) {
            return true;
          }

          // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º, –µ—Å–ª–∏ –Ω–∞—á–∞–ª–∏
          return formationOpened > 0;
        }

        // –ü–æ–¥—Å—á–µ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫
        function countUnknownCells() {
          let count = 0;
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              if (gameBoard[row][col].state === CELL_STATES.UNKNOWN) {
                count++;
              }
            }
          }
          return count;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ö–æ–¥–∞
        function updateNextMoveHint() {
          nextMoveHintCell = calculateNextMove();

          if (nextMoveHintCell) {
            nextMoveCellElement.textContent = `${nextMoveHintCell.row + 1},${nextMoveHintCell.col + 1}`;
            nextMoveCellElement.style.color = "#27ae60";
            nextMoveCellElement.style.fontWeight = "bold";

            // –ü–æ–º–µ—á–∞–µ–º –∫–ª–µ—Ç–∫—É –∫–∞–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—É—é
            gameBoard[nextMoveHintCell.row][nextMoveHintCell.col].isRecommended = true;
          } else {
            nextMoveCellElement.textContent = "--";
            nextMoveCellElement.style.color = "#666";
          }

          renderGameBoard();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏
        function toggleNextMoveMode() {
          nextMoveMode = !nextMoveMode;

          if (nextMoveMode) {
            nextMoveBtn.classList.add("active");
            nextMoveBtn.title = "–ü–æ–¥—Å–∫–∞–∑–∫–∞ —Ö–æ–¥–∞ (–≤–∫–ª)";
            updateNextMoveHint();
            showToast("–†–µ–∂–∏–º –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤–∫–ª—é—á–µ–Ω. –õ—É—á—à–∏–π —Ö–æ–¥ –±—É–¥–µ—Ç –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å—Å—è.", "info");
          } else {
            nextMoveBtn.classList.remove("active");
            nextMoveBtn.title = "–ü–æ–¥—Å–∫–∞–∑–∫–∞ —Ö–æ–¥–∞";
            // –°–Ω–∏–º–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É
            nextMoveHintCell = null;
            nextMoveCellElement.textContent = "--";
            nextMoveCellElement.style.color = "#666";
            renderGameBoard();
          }
        }

        // –≠–ö–°–ü–û–†–¢/–ò–ú–ü–û–†–¢
        function generateExportCode() {
          const codes = [];

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];

              let stateCode = CELL_CODES[cell.state];

              if (cell.hasGoldOutline) {
                stateCode = "o";
              }

              if (stateCode !== "u" || cell.hasGoldOutline) {
                const rowLetter = String.fromCharCode(65 + row);
                const cellCode = `${rowLetter}${col + 1}${stateCode}`;
                codes.push(cellCode);
              }
            }
          }

          return codes.join(",");
        }

        function showExportModal() {
          const code = generateExportCode();
          exportCodeElement.textContent = code;
          exportImportModal.classList.add("active");
          exportImportOverlay.classList.add("active");
        }

        function hideExportModal() {
          exportImportModal.classList.remove("active");
          exportImportOverlay.classList.remove("active");
        }

        function copyToClipboard() {
          const code = exportCodeElement.textContent;
          navigator.clipboard
            .writeText(code)
            .then(() => {
              const copyBtn = document.getElementById("copy-btn");
              copyBtn.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!";
              copyBtn.classList.add("copied");

              setTimeout(() => {
                copyBtn.textContent = "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å";
                copyBtn.classList.remove("copied");
              }, 2000);
            })
            .catch((err) => {
              console.error("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ", err);
            });
        }

        function importBoard() {
          const code = importInput.value.trim();
          if (!code) return;

          try {
            initGameBoard();

            const parts = code.split(",");
            let importedCount = 0;

            parts.forEach((part) => {
              const match = part.match(/^([A-E])(\d+)([gnueo])$/i);
              if (match) {
                const rowLetter = match[1].toUpperCase();
                const col = parseInt(match[2]) - 1;
                const code = match[3].toLowerCase();

                const row = rowLetter.charCodeAt(0) - 65;

                if (row >= 0 && row < rows && col >= 0 && col < cols) {
                  const cell = gameBoard[row][col];

                  if (code === "o") {
                    cell.state = CELL_STATES.UNKNOWN;
                    cell.hasGoldOutline = true;
                  } else {
                    const state = CODE_CELLS[code];
                    if (state) {
                      cell.state = state;
                      cell.hasGoldOutline = false;
                    }
                  }

                  importedCount++;
                }
              }
            });

            analyzeBoard();
            renderGameBoard();
            updateCounters();
            if (nextMoveMode) updateNextMoveHint();

            importStatus.textContent = `–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${importedCount} –∫–ª–µ—Ç–æ–∫`;
            importStatus.className = "import-status success";
            importStatus.style.display = "block";

            importInput.value = "";

            setTimeout(() => {
              importStatus.style.display = "none";
            }, 3000);
          } catch (error) {
            importStatus.textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥–∞.";
            importStatus.className = "import-status error";
            importStatus.style.display = "block";
          }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Ç–∞–∫—Ç–∏–∫ (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
        function initTacticPreviews() {
          createDiamondPreview();
          createCrossPreview();
          createDiagonalPreview();
          createTriangulationPreview();
          createExclusionPreview();
          createCornersPreview();
        }

        function createDiamondPreview() {
          const preview = document.getElementById("diamond-preview");
          preview.innerHTML = "";

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = document.createElement("div");
              cell.className = "preview-cell";

              const isStart =
                (row === 1 && col === 1) ||
                (row === 1 && col === 4) ||
                (row === 3 && col === 1) ||
                (row === 3 && col === 4);

              if (isStart) {
                cell.style.backgroundColor = "#a3e4d7";
                cell.textContent = `${row + 1},${col + 1}`;
                cell.style.fontSize = "0.6rem";
              } else {
                cell.style.backgroundColor = "#bdc3c7";
              }

              preview.appendChild(cell);
            }
          }
        }

        function createCrossPreview() {
          const preview = document.getElementById("cross-preview");
          preview.innerHTML = "";

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = document.createElement("div");
              cell.className = "preview-cell";

              const isStart =
                (row === 1 && col === 2) ||
                (row === 2 && col === 1) ||
                (row === 2 && col === 4) ||
                (row === 3 && col === 2);

              if (isStart) {
                cell.style.backgroundColor = "#a3e4d7";
                cell.textContent = `${row + 1},${col + 1}`;
                cell.style.fontSize = "0.6rem";
              } else {
                cell.style.backgroundColor = "#bdc3c7";
              }

              preview.appendChild(cell);
            }
          }
        }

        function createDiagonalPreview() {
          const preview = document.getElementById("diagonal-preview");
          preview.innerHTML = "";

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = document.createElement("div");
              cell.className = "preview-cell";

              const isStart =
                (row === 0 && col === 2) ||
                (row === 1 && col === 4) ||
                (row === 3 && col === 1) ||
                (row === 4 && col === 3);

              if (isStart) {
                cell.style.backgroundColor = "#a3e4d7";
                cell.textContent = `${row + 1},${col + 1}`;
                cell.style.fontSize = "0.6rem";
              } else {
                cell.style.backgroundColor = "#bdc3c7";
              }

              preview.appendChild(cell);
            }
          }
        }

        function createTriangulationPreview() {
          const preview = document.getElementById("triangulation-preview");
          preview.innerHTML = "";

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = document.createElement("div");
              cell.className = "preview-cell";

              const isOutline = (row === 1 && col === 1) || (row === 1 && col === 3);
              const isGold = row === 1 && col === 2;

              if (isGold) {
                cell.style.backgroundColor = "#ffd700";
                cell.textContent = "‚òÖ";
              } else if (isOutline) {
                cell.style.backgroundColor = "#ecf0f1";
                cell.style.border = "1px solid #ffa500";
              } else {
                cell.style.backgroundColor = "#bdc3c7";
              }

              preview.appendChild(cell);
            }
          }
        }

        function createExclusionPreview() {
          const preview = document.getElementById("exclusion-preview");
          preview.innerHTML = "";

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = document.createElement("div");
              cell.className = "preview-cell";

              const isCenter = row === 2 && col === 2;
              const isNeighbor =
                (row === 2 && col === 1) ||
                (row === 2 && col === 3) ||
                (row === 1 && col === 2) ||
                (row === 3 && col === 2);

              if (isCenter) {
                cell.style.backgroundColor = "#ecf0f1";
                cell.style.border = "1px solid #7f8c8d";
              } else if (isNeighbor) {
                cell.style.backgroundColor = "#7f8c8d";
              } else {
                cell.style.backgroundColor = "#bdc3c7";
              }

              preview.appendChild(cell);
            }
          }
        }

        function createCornersPreview() {
          const preview = document.getElementById("corners-preview");
          preview.innerHTML = "";

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = document.createElement("div");
              cell.className = "preview-cell";

              const isCorner =
                (row === 0 && col === 0) ||
                (row === 0 && col === 5) ||
                (row === 4 && col === 0) ||
                (row === 4 && col === 5);
              const isCenter = (row === 2 && col === 2) || (row === 2 && col === 3);

              if (isCorner) {
                cell.style.backgroundColor = "#ff6b6b";
                cell.textContent = "‚úó";
              } else if (isCenter) {
                cell.style.backgroundColor = "#a3e4d7";
                cell.textContent = "‚úì";
              } else {
                cell.style.backgroundColor = "#bdc3c7";
              }

              preview.appendChild(cell);
            }
          }
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–∞–∫—Ç–∏–∫
        function setupTacticCards() {
          document.querySelectorAll(".tactic-card").forEach((card) => {
            card.addEventListener("click", function () {
              const tactic = this.getAttribute("data-tactic");
              openTacticModal(tactic);
            });
          });
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å —Ç–∞–∫—Ç–∏–∫–æ–π (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º)
        function openTacticModal(tactic) {
          let title = "";
          let rank = "";
          let content = "";

          if (tactic === "diamond") {
            title = "–ê–ª–º–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞—Ü–∏—è";
            rank = "1";
            content = `
                        <div class="tactic-explanation">
                            <h4>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫–∏</h4>
                            <p><strong>–õ—É—á—à–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è –ø–æ–ª—è 5√ó6!</strong> –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç–∏ 4 –∫–ª–µ—Ç–∫–∏ –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ:</p>
                            <div class="coordinate-list">
                                <div class="coordinate-item">(2, 2)</div>
                                <div class="coordinate-item">(2, 5)</div>
                                <div class="coordinate-item">(4, 2)</div>
                                <div class="coordinate-item">(4, 5)</div>
                            </div>
                            <p><strong>–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong></p>
                            <ul>
                                <li>–ö–∞–∂–¥–∞—è –∫–ª–µ—Ç–∫–∞ –∏–º–µ–µ—Ç –ø–æ <strong>4 —Å–æ—Å–µ–¥–∞</strong> (–º–∞–∫—Å–∏–º—É–º)</li>
                                <li><strong>16 –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–æ—Å–µ–¥–µ–π</strong> –ø–æ–∫—Ä—ã–≤–∞—é—Ç—Å—è —Å—Ä–∞–∑—É</li>
                                <li>–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –æ—Ö–≤–∞—Ç–∞ –ø–æ–ª—è</li>
                                <li>–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏–∏ –∑–æ–ª–æ—Ç—ã—Ö —è—á–µ–µ–∫</li>
                            </ul>
                            <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –∑–æ–Ω, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ö–æ–¥–æ–≤.</p>
                        </div>
                        <div class="tactic-visualization">
                            <div class="tactic-board" id="tactic-board">
                                <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                            <div class="visual-label">–ñ–µ–ª—Ç—ã–µ –∫–ª–µ—Ç–∫–∏ - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ —Ç–æ—á–∫–∏</div>
                        </div>
                    `;
          } else if (tactic === "cross") {
            title = "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä–µ—Å—Ç";
            rank = "2";
            content = `
                        <div class="tactic-explanation">
                            <h4>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫–∏</h4>
                            <p><strong>–í—Ç–æ—Ä–∞—è –ø–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è.</strong> –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç–∏ 4 –∫–ª–µ—Ç–∫–∏:</p>
                            <div class="coordinate-list">
                                <div class="coordinate-item">(2, 3)</div>
                                <div class="coordinate-item">(3, 2)</div>
                                <div class="coordinate-item">(3, 5)</div>
                                <div class="coordinate-item">(4, 3)</div>
                            </div>
                            <p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</strong></p>
                            <ul>
                                <li>–§–æ–∫—É—Å –Ω–∞ <strong>—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö</strong> (3 –∏ 4)</li>
                                <li>–•–æ—Ä–æ—à–æ –≤—ã—è–≤–ª—è–µ—Ç <strong>–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã</strong> –∑–æ–ª–æ—Ç—ã—Ö —è—á–µ–µ–∫</li>
                                <li>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –∑–æ–ª–æ—Ç–∞</li>
                                <li>–°–æ–∑–¥–∞–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</li>
                            </ul>
                            <p><strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –ï—Å–ª–∏ –ø–æ–¥–æ–∑—Ä–µ–≤–∞–µ—Ç–µ, —á—Ç–æ –∑–æ–ª–æ—Ç–æ —Å–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –ø–æ–ª—è.</p>
                        </div>
                        <div class="tactic-visualization">
                            <div class="tactic-board" id="tactic-board">
                                <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                            <div class="visual-label">–°—Ç–∞—Ä—Ç–æ–≤—ã–µ —Ç–æ—á–∫–∏ –æ–±—Ä–∞–∑—É—é—Ç —Å–º–µ—â–µ–Ω–Ω—ã–π –∫—Ä–µ—Å—Ç</div>
                        </div>
                    `;
          } else if (tactic === "diagonal") {
            title = "–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —Å–∫–∞–Ω–µ—Ä";
            rank = "3";
            content = `
                        <div class="tactic-explanation">
                            <h4>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫–∏</h4>
                            <p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –∏–≥—Ä–æ–∫–æ–≤.</strong> –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç–∏ 4 –∫–ª–µ—Ç–∫–∏:</p>
                            <div class="coordinate-list">
                                <div class="coordinate-item">(1, 3)</div>
                                <div class="coordinate-item">(2, 5)</div>
                                <div class="coordinate-item">(4, 2)</div>
                                <div class="coordinate-item">(5, 4)</div>
                            </div>
                            <p><strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–∞–∫—Ç–∏–∫–∏:</strong></p>
                            <ul>
                                <li>–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—Å—ë –ø–æ–ª–µ</li>
                                <li>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ <strong>"–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–≥–æ" —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è</strong> –∑–æ–ª–æ—Ç—ã—Ö —è—á–µ–µ–∫</li>
                                <li>–î–∞—ë—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ <strong>–∫—Ä–∞–π–Ω–∏—Ö –∑–æ–Ω–∞—Ö</strong>, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è</li>
                                <li>–°–æ–∑–¥–∞–µ—Ç –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</li>
                            </ul>
                            <p><strong>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫:</strong> –û–¥–Ω–∞ —Ç–æ—á–∫–∞ (1,3) –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ 3 —Å–æ—Å–µ–¥–∞ –≤–º–µ—Å—Ç–æ 4.</p>
                        </div>
                        <div class="tactic-visualization">
                            <div class="tactic-board" id="tactic-board">
                                <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                            <div class="visual-label">–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö —Ç–æ—á–µ–∫</div>
                        </div>
                    `;
          } else if (tactic === "triangulation") {
            title = "–¢—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏—è";
            rank = "";
            content = `
                        <div class="tactic-explanation">
                            <h4>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫–∏</h4>
                            <p><strong>–°–∞–º—ã–π –º–æ—â–Ω—ã–π –ø—Ä–∏–µ–º –≤ –∏–≥—Ä–µ!</strong> –ï—Å–ª–∏ –≤—ã –æ—Ç–∫—Ä—ã–ª–∏ –¥–≤–µ –∫–ª–µ—Ç–∫–∏ —Å –∑–æ–ª–æ—Ç—ã–º–∏ –∫–æ–Ω—Ç—É—Ä–∞–º–∏, –∏ –æ–Ω–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –∫–ª–µ—Ç–∫—É:</p>
                            <p><strong>–ö–ª–µ—Ç–∫–∞ –ê (–∑–æ–ª–æ—Ç–æ–π –∫–æ–Ω—Ç—É—Ä)</strong><br>
                            <strong>–ö–ª–µ—Ç–∫–∞ –ë (–Ω–µ –æ—Ç–∫—Ä—ã—Ç–∞)</strong><br>
                            <strong>–ö–ª–µ—Ç–∫–∞ –í (–∑–æ–ª–æ—Ç–æ–π –∫–æ–Ω—Ç—É—Ä)</strong></p>
                            <p><strong>–° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 99% –∑–æ–ª–æ—Ç–∞—è —è—á–µ–π–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ö–ª–µ—Ç–∫–µ –ë!</strong></p>
                            <p><strong>–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –ö–∞–∂–¥—ã–π –∑–æ–ª–æ—Ç–æ–π –∫–æ–Ω—Ç—É—Ä —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –≤ –æ–¥–Ω–æ–º –∏–∑ –µ–≥–æ —Å–æ—Å–µ–¥–µ–π –µ—Å—Ç—å –∑–æ–ª–æ—Ç–æ. –ï—Å–ª–∏ –¥–≤–∞ –∫–æ–Ω—Ç—É—Ä–∞ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –∫–ª–µ—Ç–∫—É, –æ–Ω–∞ –ø–æ—á—Ç–∏ –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –∑–æ–ª–æ—Ç–∞—è.</p>
                            <p><strong>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏—Ç–µ —Ç–∞–∫—É—é —Å–∏—Ç—É–∞—Ü–∏—é ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –æ–±—â—É—é –∫–ª–µ—Ç–∫—É –ø–µ—Ä–≤–æ–π!</p>
                        </div>
                        <div class="tactic-visualization">
                            <div class="tactic-board" id="tactic-board">
                                <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                            <div class="visual-label">–ö–æ–Ω—Ç—É—Ä—ã —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –∑–æ–ª–æ—Ç—É—é —è—á–µ–π–∫—É –º–µ–∂–¥—É –Ω–∏–º–∏</div>
                        </div>
                    `;
          } else if (tactic === "exclusion") {
            title = "–ú–µ—Ç–æ–¥ –∏—Å–∫–ª—é—á–µ–Ω–∏—è";
            rank = "";
            content = `
                        <div class="tactic-explanation">
                            <h4>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫–∏</h4>
                            <p><strong>–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ö–æ–¥–æ–≤!</strong> –ö–ª–µ—Ç–∫–∏ —Å —Å–µ—Ä—ã–º–∏ –∏–ª–∏ –∫—Ä–∞—Å–Ω—ã–º–∏ —Ä–∞–º–∫–∞–º–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –≥–¥–µ –∏—Å–∫–∞—Ç—å <strong>–ù–ï –ù–ê–î–û</strong>.</p>
                            <p><strong>–ü—Ä–∞–≤–∏–ª–æ:</strong> –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∞ (–æ–±—ã—á–Ω–∞—è) –∏ –Ω–µ –∏–º–µ–µ—Ç –∑–æ–ª–æ—Ç–æ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞ ‚Üí –≤—Å–µ –µ—ë —Å–æ—Å–µ–¥–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø—É—Å—Ç—ã–º–∏.</p>
                            <p><strong>–ü—Ä–∏–º–µ—Ä:</strong> –ï—Å–ª–∏ –≤—ã –æ—Ç–∫—Ä—ã–ª–∏ –∫–ª–µ—Ç–∫—É (3,3) –∏ —É –Ω–µ—ë –Ω–µ—Ç –∑–æ–ª–æ—Ç–æ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞, —Ç–æ –∫–ª–µ—Ç–∫–∏ (2,3), (3,2), (3,4), (4,3) —Ç–æ—á–Ω–æ –ø—É—Å—Ç—ã–µ.</p>
                            <p><strong>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong></p>
                            <ul>
                                <li>–ù–µ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–æ—Å–µ–¥–µ–π –∫–ª–µ—Ç–æ–∫ —Å —Å–µ—Ä—ã–º–∏/–∫—Ä–∞—Å–Ω—ã–º–∏ —Ä–∞–º–∫–∞–º–∏</li>
                                <li>–û—Ç–º–µ—á–∞–π—Ç–µ —Ç–∞–∫–∏–µ –∫–ª–µ—Ç–∫–∏ –∫–∞–∫ –ø—É—Å—Ç—ã–µ –≤ –ø–æ–º–æ—â–Ω–∏–∫–µ</li>
                                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Å—É–∂–µ–Ω–∏—è –∑–æ–Ω—ã –ø–æ–∏—Å–∫–∞</li>
                            </ul>
                            <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –≠–∫–æ–Ω–æ–º–∏—è 20-30% —Ö–æ–¥–æ–≤ –∑–∞ –∏–≥—Ä—É!</p>
                        </div>
                        <div class="tactic-visualization">
                            <div class="tactic-board" id="tactic-board">
                                <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                            <div class="visual-label">–°–µ—Ä–∞—è —Ä–∞–º–∫–∞ –∏ –µ—ë –ø—É—Å—Ç—ã–µ —Å–æ—Å–µ–¥–∏</div>
                        </div>
                    `;
          } else if (tactic === "avoid-corners") {
            title = "–ò–∑–±–µ–≥–∞–π—Ç–µ —É–≥–ª–æ–≤";
            rank = "";
            content = `
                        <div class="tactic-explanation">
                            <h4>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫–∏</h4>
                            <p><strong>–û—Å–Ω–æ–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –Ω–æ–≤–∏—á–∫–æ–≤!</strong> –ù–µ –Ω–∞—á–∏–Ω–∞–π—Ç–µ –∏–≥—Ä—É —Å —É–≥–ª–æ–≤—ã—Ö –∫–ª–µ—Ç–æ–∫.</p>
                            <p><strong>–ü–æ—á–µ–º—É —É–≥–ª—ã –ø–ª–æ—Ö–∏:</strong></p>
                            <ul>
                                <li><strong>–£–≥–ª–æ–≤–∞—è –∫–ª–µ—Ç–∫–∞ –∏–º–µ–µ—Ç –≤—Å–µ–≥–æ 2-3 —Å–æ—Å–µ–¥–∞</strong> (–≤–º–µ—Å—Ç–æ 4)</li>
                                <li>–ú–∞–ª–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –∫–∞–∂–¥–æ–≥–æ —Ö–æ–¥–∞</li>
                                <li>–°–ª–æ–∂–Ω–µ–µ —Ç—Ä–∏–∞–Ω–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∑–æ–ª–æ—Ç—ã—Ö —è—á–µ–µ–∫</li>
                                <li>–•—É–∂–µ –æ—Ö–≤–∞—Ç –ø–æ–ª—è</li>
                            </ul>
                            <p><strong>–ü–æ—á–µ–º—É —Ü–µ–Ω—Ç—Ä –ª—É—á—à–µ:</strong></p>
                            <ul>
                                <li><strong>–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–ª–µ—Ç–∫–∞ –∏–º–µ–µ—Ç 4 —Å–æ—Å–µ–¥–∞</strong> (–º–∞–∫—Å–∏–º—É–º)</li>
                                <li>–ë–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –∫–∞–∂–¥–æ–≥–æ —Ö–æ–¥–∞</li>
                                <li>–õ—É—á—à–µ –¥–ª—è —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏–∏</li>
                                <li>–†–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–π –æ—Ö–≤–∞—Ç –ø–æ–ª—è</li>
                            </ul>
                            <p><strong>–ü—Ä–∞–≤–∏–ª–æ:</strong> –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å –∫–ª–µ—Ç–æ–∫, —É –∫–æ—Ç–æ—Ä—ã—Ö 4 —Å–æ—Å–µ–¥–∞!</p>
                        </div>
                        <div class="tactic-visualization">
                            <div class="tactic-board" id="tactic-board">
                                <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                            <div class="visual-label">‚úó - –ø–ª–æ—Ö–∏–µ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ —Ç–æ—á–∫–∏, ‚úì - —Ö–æ—Ä–æ—à–∏–µ</div>
                        </div>
                    `;
          }

          // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç
          modalTitle.textContent = title;
          modalRank.textContent = rank;
          if (rank === "") {
            modalRank.style.display = "none";
          } else {
            modalRank.style.display = "inline-block";
          }
          modalContent.innerHTML = content;

          // –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è —Ç–µ–∫—É—â–µ–π —Ç–∞–∫—Ç–∏–∫–∏
          createTacticVisualization(tactic);

          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
          modalOverlay.classList.add("active");
          document.body.style.overflow = "hidden";
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
        function createTacticVisualization(tactic) {
          const board = document.getElementById("tactic-board");
          if (!board) return;

          board.innerHTML = "";

          if (tactic === "diamond") {
            // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–º–∞–∑–Ω–æ–π —Ñ–æ—Ä–º–∞—Ü–∏–∏
            for (let row = 0; row < rows; row++) {
              for (let col = 0; col < cols; col++) {
                const cell = document.createElement("div");

                // –ê–ª–º–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞—Ü–∏—è
                const isStart =
                  (row === 1 && col === 1) ||
                  (row === 1 && col === 4) ||
                  (row === 3 && col === 1) ||
                  (row === 3 && col === 4);

                if (isStart) {
                  cell.className = "visual-cell start";
                  cell.textContent = `${row + 1},${col + 1}`;
                } else {
                  cell.className = "visual-cell normal";
                }

                board.appendChild(cell);
              }
            }
          } else if (tactic === "cross") {
            // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –∫—Ä–µ—Å—Ç–∞
            for (let row = 0; row < rows; row++) {
              for (let col = 0; col < cols; col++) {
                const cell = document.createElement("div");

                // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä–µ—Å—Ç
                const isStart =
                  (row === 1 && col === 2) ||
                  (row === 2 && col === 1) ||
                  (row === 2 && col === 4) ||
                  (row === 3 && col === 2);

                if (isStart) {
                  cell.className = "visual-cell start";
                  cell.textContent = `${row + 1},${col + 1}`;
                } else {
                  cell.className = "visual-cell normal";
                }

                board.appendChild(cell);
              }
            }
          } else if (tactic === "diagonal") {
            // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∫–∞–Ω–µ—Ä–∞
            for (let row = 0; row < rows; row++) {
              for (let col = 0; col < cols; col++) {
                const cell = document.createElement("div");

                // –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —Å–∫–∞–Ω–µ—Ä
                const isStart =
                  (row === 0 && col === 2) ||
                  (row === 1 && col === 4) ||
                  (row === 3 && col === 1) ||
                  (row === 4 && col === 3);

                if (isStart) {
                  cell.className = "visual-cell start";
                  cell.textContent = `${row + 1},${col + 1}`;
                } else {
                  cell.className = "visual-cell normal";
                }

                board.appendChild(cell);
              }
            }
          } else if (tactic === "triangulation") {
            // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏–∏
            for (let row = 0; row < rows; row++) {
              for (let col = 0; col < cols; col++) {
                const cell = document.createElement("div");

                // –î–≤–∞ –∫–æ–Ω—Ç—É—Ä–∞ —Å –∑–æ–ª–æ—Ç–æ–π —è—á–µ–π–∫–æ–π –º–µ–∂–¥—É –Ω–∏–º–∏
                const isOutline = (row === 1 && col === 1) || (row === 1 && col === 3);
                const isGold = row === 1 && col === 2;

                if (isGold) {
                  cell.className = "visual-cell gold";
                  cell.textContent = "‚òÖ";
                } else if (isOutline) {
                  cell.className = "visual-cell gold-outline";
                  cell.textContent = "A/C";
                } else if (row === 1 && col === 2) {
                  cell.className = "visual-cell target";
                  cell.textContent = "–ë";
                } else {
                  cell.className = "visual-cell normal";
                }

                board.appendChild(cell);
              }
            }
          } else if (tactic === "exclusion") {
            // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
            for (let row = 0; row < rows; row++) {
              for (let col = 0; col < cols; col++) {
                const cell = document.createElement("div");

                // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–ª–µ—Ç–∫–∞ —Å —Å–µ—Ä–æ–π —Ä–∞–º–∫–æ–π –∏ –µ—ë —Å–æ—Å–µ–¥–∏
                const isCenter = row === 2 && col === 2;
                const isNeighbor =
                  (row === 2 && col === 1) ||
                  (row === 2 && col === 3) ||
                  (row === 1 && col === 2) ||
                  (row === 3 && col === 2);

                if (isCenter) {
                  cell.className = "visual-cell normal";
                  cell.textContent = "X";
                } else if (isNeighbor) {
                  cell.className = "visual-cell empty";
                  cell.textContent = "‚úó";
                } else {
                  cell.className = "visual-cell normal";
                }

                board.appendChild(cell);
              }
            }
          } else if (tactic === "avoid-corners") {
            // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è "–ò–∑–±–µ–≥–∞–π—Ç–µ —É–≥–ª–æ–≤"
            for (let row = 0; row < rows; row++) {
              for (let col = 0; col < cols; col++) {
                const cell = document.createElement("div");

                // –£–≥–ª—ã vs —Ü–µ–Ω—Ç—Ä
                const isCorner =
                  (row === 0 && col === 0) ||
                  (row === 0 && col === 5) ||
                  (row === 4 && col === 0) ||
                  (row === 4 && col === 5);
                const isCenter = (row === 2 && col === 2) || (row === 2 && col === 3);

                if (isCorner) {
                  cell.className = "visual-cell empty";
                  cell.textContent = "‚úó";
                } else if (isCenter) {
                  cell.className = "visual-cell start";
                  cell.textContent = "‚úì";
                } else {
                  cell.className = "visual-cell normal";
                }

                board.appendChild(cell);
              }
            }
          }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showToast(message, type = "info") {
          const toast = document.createElement("div");
          toast.textContent = message;
          toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 12px 20px;
                    border-radius: 6px;
                    color: white;
                    font-weight: bold;
                    z-index: 2000;
                    opacity: 0;
                    transform: translateX(100px);
                    transition: opacity 0.3s, transform 0.3s;
                `;

          if (type === "success") {
            toast.style.backgroundColor = "#27ae60";
          } else if (type === "error") {
            toast.style.backgroundColor = "#e74c3c";
          } else {
            toast.style.backgroundColor = "#3498db";
          }

          document.body.appendChild(toast);

          setTimeout(() => {
            toast.style.opacity = "1";
            toast.style.transform = "translateX(0)";
          }, 10);

          setTimeout(() => {
            toast.style.opacity = "0";
            toast.style.transform = "translateX(100px)";
            setTimeout(() => {
              document.body.removeChild(toast);
            }, 300);
          }, 3000);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function closeModal() {
          modalOverlay.classList.remove("active");
          document.body.style.overflow = "auto";
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∫–ª–µ—Ç–∫–∏
        function isValidCell(row, col) {
          return row >= 0 && row < rows && col >= 0 && col < cols;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–ª–µ—Ç–æ–∫
        function getAdjacentCells(row, col) {
          const neighbors = [];

          if (row > 0) neighbors.push({ row: row - 1, col });
          if (row < rows - 1) neighbors.push({ row: row + 1, col });
          if (col > 0) neighbors.push({ row, col: col - 1 });
          if (col < cols - 1) neighbors.push({ row, col: col + 1 });

          return neighbors;
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        function renderGameBoard() {
          gameBoardElement.innerHTML = "";

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];
              const cellElement = document.createElement("div");

              let cellClass = `cell ${cell.state}`;

              const isEmpty = emptyCells.some((emptyCell) => emptyCell.row === row && emptyCell.col === col);

              const isPossibleGold = possibleGoldCells.some(
                (goldCell) => goldCell.row === row && goldCell.col === col && goldCell.chance >= 50
              );

              if (cell.state === CELL_STATES.GOLD) {
                cellClass = `cell ${CELL_STATES.GOLD}`;
              } else if (isEmpty && cell.state === CELL_STATES.UNKNOWN) {
                cellClass = `cell ${CELL_STATES.EMPTY}`;
                cellElement.textContent = "";
              } else if (isPossibleGold && cell.state === CELL_STATES.UNKNOWN) {
                cellClass = `cell ${CELL_STATES.POSSIBLE_GOLD}`;
              } else if (cell.state === CELL_STATES.NORMAL) {
                cellClass = `cell ${CELL_STATES.NORMAL}`;
              } else {
                cellClass = `cell ${CELL_STATES.UNKNOWN}`;
              }

              cellElement.className = cellClass;

              const cellNumber = document.createElement("div");
              cellNumber.className = "cell-number";
              cellNumber.textContent = `${row + 1},${col + 1}`;
              cellElement.appendChild(cellNumber);

              if (cell.hasGoldOutline) {
                cellElement.classList.add("gold-outline");
              }

              if (nextMoveMode && cell.isRecommended) {
                cellElement.classList.add("next-move-hint");
              }

              if (cell.state === CELL_STATES.GOLD) {
                cellClass = `cell ${CELL_STATES.GOLD}`;
                cellElement.textContent = "‚òÖ";
              }

              if (cell.goldChance > 0 && cell.state === CELL_STATES.UNKNOWN) {
                const chanceElement = document.createElement("div");
                chanceElement.className = "gold-chance";

                if (cell.goldChance >= 50) {
                  chanceElement.classList.add("high");
                } else {
                  chanceElement.classList.add("low");
                }

                chanceElement.textContent = `${Math.round(cell.goldChance)}%`;
                cellElement.appendChild(chanceElement);
              }

              cellElement.addEventListener("click", () => handleCellClick(row, col));

              gameBoardElement.appendChild(cellElement);
            }
          }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–ª–µ—Ç–∫–µ
        function handleCellClick(row, col) {
          const cell = gameBoard[row][col];

          if (outlineMode) {
            // –†–µ–∂–∏–º –∫–æ–Ω—Ç—É—Ä–æ–≤: –¢–û–õ–¨–ö–û –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º –∫–æ–Ω—Ç—É—Ä
            cell.hasGoldOutline = !cell.hasGoldOutline;
          } else {
            // –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º: –º–µ–Ω—è–µ–º –¢–û–õ–¨–ö–û —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–Ω—Ç—É—Ä –ù–ï —Ç—Ä–æ–≥–∞–µ–º
            if (cell.state === CELL_STATES.UNKNOWN) {
              cell.state = CELL_STATES.NORMAL;
            } else if (cell.state === CELL_STATES.NORMAL) {
              cell.state = CELL_STATES.GOLD;
            } else if (cell.state === CELL_STATES.GOLD) {
              cell.state = CELL_STATES.UNKNOWN;
            }
            // –ï—Å–ª–∏ cell.state === CELL_STATES.EMPTY –∏–ª–∏ –¥—Ä—É–≥–∏–µ - –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
          }

          analyzeBoard();
          renderGameBoard();
          updateCounters();
          if (nextMoveMode) updateNextMoveHint();
        }

        // –ê–Ω–∞–ª–∏–∑ –ø–æ–ª—è —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π (–¥–æ–±–∞–≤–ª–µ–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥)
        function analyzeBoard() {
          emptyCells = [];
          possibleGoldCells = [];

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              gameBoard[row][col].goldChance = 0;
            }
          }

          // –®–ê–ì 1: –ü–£–°–¢–´–ï –°–û–°–ï–î–ò –ö–õ–ï–¢–û–ö –ë–ï–ó –ö–û–ù–¢–£–†–û–í
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              const cell = gameBoard[row][col];

              // –ï—Å–ª–∏ —ç—Ç–æ –û–ë–´–ß–ù–ê–Ø –∏–ª–∏ –ó–û–õ–û–¢–ê–Ø –∫–ª–µ—Ç–∫–∞ –ë–ï–ó –∫–æ–Ω—Ç—É—Ä–∞
              if ((cell.state === CELL_STATES.NORMAL || cell.state === CELL_STATES.GOLD) && !cell.hasGoldOutline) {
                const neighbors = getAdjacentCells(row, col);

                neighbors.forEach((neighbor) => {
                  const neighborCell = gameBoard[neighbor.row][neighbor.col];

                  // –ï—Å–ª–∏ —Å–æ—Å–µ–¥ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω –∏ –Ω–µ –∑–æ–ª–æ—Ç–æ–π
                  if (neighborCell.state === CELL_STATES.UNKNOWN) {
                    if (!emptyCells.some((c) => c.row === neighbor.row && c.col === neighbor.col)) {
                      emptyCells.push({ row: neighbor.row, col: neighbor.col });
                    }
                  }
                });
              }
            }
          }

          // –®–ê–ì 2: –°–û–ë–ò–†–ê–ï–ú –ö–õ–ï–¢–ö–ò –° –ö–û–ù–¢–£–†–ê–ú–ò
          const outlineCells = [];
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              if (gameBoard[row][col].hasGoldOutline) {
                outlineCells.push({ row, col });
              }
            }
          }

          // –®–ê–ì 3: –õ–û–ì–ò–ß–ï–°–ö–ò–ô –í–´–í–û–î - –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –ó–û–õ–û–¢–û
          // –ï—Å–ª–∏ —É –∫–æ–Ω—Ç—É—Ä–∞ –æ—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–æ—Å–µ–¥ - –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–æ–ª–æ—Ç—ã–º
          const forcedGoldCells = [];

          outlineCells.forEach((outlineCell) => {
            const { row, col } = outlineCell;
            const neighbors = getAdjacentCells(row, col);

            // –°—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ —É –∫–æ–Ω—Ç—É—Ä–∞ —É–∂–µ –Ω–∞–π–¥–µ–Ω–æ –∑–æ–ª–æ—Ç–∞ –∏ —Å–∫–æ–ª—å–∫–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ—Å–µ–¥–µ–π
            let goldCount = 0;
            let unknownNeighbors = [];

            neighbors.forEach((neighbor) => {
              const neighborCell = gameBoard[neighbor.row][neighbor.col];
              if (neighborCell.state === CELL_STATES.GOLD) {
                goldCount++;
              } else if (
                neighborCell.state === CELL_STATES.UNKNOWN &&
                !emptyCells.some((ec) => ec.row === neighbor.row && ec.col === neighbor.col)
              ) {
                unknownNeighbors.push(neighbor);
              }
            });

            // –ï—Å–ª–∏ —É –∫–æ–Ω—Ç—É—Ä–∞ –µ—â–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∑–æ–ª–æ—Ç–æ –∏ –æ—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–æ—Å–µ–¥
            // –≠—Ç–æ—Ç —Å–æ—Å–µ–¥ –î–û–õ–ñ–ï–ù –±—ã—Ç—å –∑–æ–ª–æ—Ç—ã–º (–º–∏–Ω–∏–º—É–º 1 –∑–æ–ª–æ—Ç–æ!)
            if (goldCount === 0 && unknownNeighbors.length === 1) {
              const forcedGold = unknownNeighbors[0];
              forcedGoldCells.push(forcedGold);
            }
          });

          // –®–ê–ì 4: –ê–ù–ê–õ–ò–ó –ö–û–ù–¢–£–†–û–í
          const goldChanceMap = new Map();

          outlineCells.forEach((outlineCell) => {
            const { row, col } = outlineCell;
            const neighbors = getAdjacentCells(row, col);

            let goldCount = 0;
            let normalCount = 0;
            let unknownCount = 0;

            neighbors.forEach((neighbor) => {
              const neighborCell = gameBoard[neighbor.row][neighbor.col];
              if (neighborCell.state === CELL_STATES.GOLD) goldCount++;
              if (neighborCell.state === CELL_STATES.NORMAL) normalCount++;
              if (neighborCell.state === CELL_STATES.UNKNOWN) unknownCount++;
            });

            // –ë–∞–∑–æ–≤—ã–π —à–∞–Ω—Å –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞
            let baseChancePerCell = 0;

            if (goldCount === 0) {
              // –ï—Å–ª–∏ —É –∫–æ–Ω—Ç—É—Ä–∞ –Ω–µ—Ç –∑–æ–ª–æ—Ç–∞, –º–∏–Ω–∏–º—É–º 1 –∑–æ–ª–æ—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ä–µ–¥–∏ —Å–æ—Å–µ–¥–µ–π
              if (unknownCount > 0) {
                baseChancePerCell = 100 / unknownCount;
              }
            } else {
              // –ï—Å–ª–∏ —É –∫–æ–Ω—Ç—É—Ä–∞ —É–∂–µ –µ—Å—Ç—å –∑–æ–ª–æ—Ç–æ, —à–∞–Ω—Å—ã —Å–Ω–∏–∂–∞—é—Ç—Å—è
              baseChancePerCell = Math.max(100 - goldCount * 50, 10) / Math.max(unknownCount, 1);
            }

            // –ü—Ä–∏–º–µ–Ω—è–µ–º —à–∞–Ω—Å—ã –∫ –∫–∞–∂–¥–æ–º—É –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º—É —Å–æ—Å–µ–¥—É
            neighbors.forEach((neighbor) => {
              const neighborCell = gameBoard[neighbor.row][neighbor.col];

              if (
                neighborCell.state === CELL_STATES.UNKNOWN &&
                !emptyCells.some((ec) => ec.row === neighbor.row && ec.col === neighbor.col)
              ) {
                const key = `${neighbor.row},${neighbor.col}`;
                let currentChance = baseChancePerCell;

                if (goldChanceMap.has(key)) {
                  // –í–ê–ñ–ù–û: –°–£–ú–ú–ò–†–£–ï–ú —à–∞–Ω—Å—ã –æ—Ç —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤, –Ω–æ –Ω–µ –±–æ–ª–µ–µ 95%
                  const existingChance = goldChanceMap.get(key).chance;
                  currentChance = existingChance + baseChancePerCell * 0.7; // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç 0.7 —á—Ç–æ–±—ã –Ω–µ –∑–∞—à–∫–∞–ª–∏–≤–∞–ª–æ
                }

                goldChanceMap.set(key, {
                  row: neighbor.row,
                  col: neighbor.col,
                  chance: Math.min(currentChance, 95),
                });
              }
            });
          });

          // –®–ê–ì 4.5: –û–°–û–ë–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –ö–õ–ï–¢–û–ö –ú–ï–ñ–î–£ –ö–û–ù–¢–£–†–ê–ú–ò
          goldChanceMap.forEach((value, key) => {
            const { row, col, chance } = value;

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç —Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤ —ç—Ç–∞ –∫–ª–µ—Ç–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç —à–∞–Ω—Å—ã
            let outlineCount = 0;
            const neighbors = getAdjacentCells(row, col);

            neighbors.forEach((neighbor) => {
              if (gameBoard[neighbor.row][neighbor.col].hasGoldOutline) {
                outlineCount++;
              }
            });

            // –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç —à–∞–Ω—Å—ã –æ—Ç 2+ –∫–æ–Ω—Ç—É—Ä–æ–≤
            if (outlineCount >= 2) {
              // –ü–æ–≤—ã—à–∞–µ–º —à–∞–Ω—Å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ
              const boostedChance = Math.min(chance * 1.5, 90);
              goldChanceMap.set(key, {
                row: row,
                col: col,
                chance: boostedChance,
              });

              // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –µ—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –†–Ø–î–û–ú —Å –¥–≤—É–º—è –∫–æ–Ω—Ç—É—Ä–∞–º–∏
              // (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ—Å–µ–¥ –æ–±–æ–∏—Ö, –Ω–æ –≤ –∑–æ–Ω–µ –≤–ª–∏—è–Ω–∏—è)
              // –≠—Ç–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏—è!
            }
          });

          // –®–ê–ì 5: –¢–†–ò–ê–ù–ì–£–õ–Ø–¶–ò–Ø (–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –®–ê–ù–°)
          for (let i = 0; i < outlineCells.length; i++) {
            for (let j = i + 1; j < outlineCells.length; j++) {
              const cell1 = outlineCells[i];
              const cell2 = outlineCells[j];

              // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ç—É—Ä–∞–º–∏
              // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å–æ—Å–µ–¥—Å—Ç–≤–æ
              if (cell1.row === cell2.row && Math.abs(cell1.col - cell2.col) === 2) {
                const middleCol = Math.min(cell1.col, cell2.col) + 1;
                const middleRow = cell1.row;

                // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –°–¢–†–û–ö–ê - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ hasGoldOutline
                if (
                  isValidCell(middleRow, middleCol) &&
                  gameBoard[middleRow][middleCol].state === CELL_STATES.UNKNOWN &&
                  !gameBoard[middleRow][middleCol].hasGoldOutline
                ) {
                  const key = `${middleRow},${middleCol}`;
                  goldChanceMap.set(key, {
                    row: middleRow,
                    col: middleCol,
                    chance: 95, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —à–∞–Ω—Å –¥–ª—è —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏–∏
                  });
                }
              }

              // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å–µ–¥—Å—Ç–≤–æ
              if (cell1.col === cell2.col && Math.abs(cell1.row - cell2.row) === 2) {
                const middleRow = Math.min(cell1.row, cell2.row) + 1;
                const middleCol = cell1.col;

                // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –°–¢–†–û–ö–ê
                if (
                  isValidCell(middleRow, middleCol) &&
                  gameBoard[middleRow][middleCol].state === CELL_STATES.UNKNOWN &&
                  !gameBoard[middleRow][middleCol].hasGoldOutline
                ) {
                  const key = `${middleRow},${middleCol}`;
                  goldChanceMap.set(key, {
                    row: middleRow,
                    col: middleCol,
                    chance: 95,
                  });
                }
              }

              // –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å–µ–¥—Å—Ç–≤–æ
              if (Math.abs(cell1.row - cell2.row) === 1 && Math.abs(cell1.col - cell2.col) === 1) {
                // –ö–ª–µ—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—Å–µ–¥—Å—Ç–≤—É–µ—Ç —Å –æ–±–æ–∏–º–∏ –∫–æ–Ω—Ç—É—Ä–∞–º–∏
                const possibleCells = [
                  { row: cell1.row, col: cell2.col },
                  { row: cell2.row, col: cell1.col },
                ];

                possibleCells.forEach((pos) => {
                  // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –°–¢–†–û–ö–ê - –∏—Å–ø–æ–ª—å–∑—É–µ–º pos.row –∏ pos.col
                  if (
                    isValidCell(pos.row, pos.col) &&
                    gameBoard[pos.row][pos.col].state === CELL_STATES.UNKNOWN &&
                    !gameBoard[pos.row][pos.col].hasGoldOutline
                  ) {
                    const key = `${pos.row},${pos.col}`;
                    const existingChance = goldChanceMap.has(key) ? goldChanceMap.get(key).chance : 0;
                    goldChanceMap.set(key, {
                      row: pos.row,
                      col: pos.col,
                      chance: Math.max(existingChance, 80), // –í—ã—Å–æ–∫–∏–π —à–∞–Ω—Å
                    });
                  }
                });
              }
            }
          }

          // –®–ê–ì 6: –ü–†–ò–ú–ï–ù–Ø–ï–ú –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –ó–û–õ–û–¢–û (100% –®–ê–ù–°)
          forcedGoldCells.forEach((forcedGold) => {
            const key = `${forcedGold.row},${forcedGold.col}`;
            goldChanceMap.set(key, {
              row: forcedGold.row,
              col: forcedGold.col,
              chance: 100,
            });
          });

          // –®–ê–ì 7: –û–ë–ù–û–í–õ–Ø–ï–ú –®–ê–ù–°–´
          goldChanceMap.forEach((value, key) => {
            const { row, col, chance } = value;

            const finalChance = Math.min(chance, 100);
            gameBoard[row][col].goldChance = finalChance;

            if (finalChance >= 50 && gameBoard[row][col].state === CELL_STATES.UNKNOWN) {
              possibleGoldCells.push({ row, col, chance: finalChance });
            }
          });

          // –®–ê–ì 8: –£–ß–ò–¢–´–í–ê–ï–ú –ù–ê–ô–î–ï–ù–ù–´–ï –ó–û–õ–û–¢–´–ï –Ø–ß–ï–ô–ö–ò
          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              if (gameBoard[row][col].state === CELL_STATES.GOLD) {
                const neighbors = getAdjacentCells(row, col);

                neighbors.forEach((neighbor) => {
                  if (
                    isValidCell(neighbor.row, neighbor.col) &&
                    gameBoard[neighbor.row][neighbor.col].hasGoldOutline &&
                    gameBoard[neighbor.row][neighbor.col].state === CELL_STATES.UNKNOWN
                  ) {
                    // –ö–ª–µ—Ç–∫–∏ —Å –∫–æ–Ω—Ç—É—Ä–∞–º–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–æ–ª–æ—Ç—ã–º–∏ (–æ—Å—Ç–∞–≤–ª—è–µ–º —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–æ)
                    if (!emptyCells.some((c) => c.row === neighbor.row && c.col === neighbor.col)) {
                      emptyCells.push({ row: neighbor.row, col: neighbor.col });
                    }

                    const index = possibleGoldCells.findIndex((c) => c.row === neighbor.row && c.col === neighbor.col);
                    if (index !== -1) {
                      possibleGoldCells.splice(index, 1);
                    }

                    gameBoard[neighbor.row][neighbor.col].goldChance = 0;
                  }
                });
              }
            }
          }

          // –®–ê–ì 9: –ö–õ–ï–¢–ö–ò –° –ö–û–ù–¢–£–†–ê–ú–ò –ù–ï –ú–û–ì–£–¢ –ë–´–¢–¨ –ó–û–õ–û–¢–´–ú–ò
          outlineCells.forEach((cell) => {
            if (gameBoard[cell.row][cell.col].state === CELL_STATES.UNKNOWN) {
              if (!emptyCells.some((c) => c.row === cell.row && c.col === cell.col)) {
                emptyCells.push({ row: cell.row, col: cell.col });
              }

              const index = possibleGoldCells.findIndex((c) => c.row === cell.row && c.col === cell.col);
              if (index !== -1) {
                possibleGoldCells.splice(index, 1);
              }

              gameBoard[cell.row][cell.col].goldChance = 0;
            }
          });

          updateCounters();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤
        function updateCounters() {
          let goldCount = 0;

          for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
              if (gameBoard[row][col].state === CELL_STATES.GOLD) {
                goldCount++;
              }
            }
          }

          goldCountElement.textContent = goldCount;
          emptyCountElement.textContent = emptyCells.length;
          possibleGoldCountElement.textContent = possibleGoldCells.length;
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –∫–æ–Ω—Ç—É—Ä–æ–≤
        function toggleOutlineMode() {
          outlineMode = !outlineMode;

          if (outlineMode) {
            outlineModeBtn.classList.add("active");
            showToast("–†–µ–∂–∏–º –∑–æ–ª–æ—Ç—ã—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤ –≤–∫–ª—é—á–µ–Ω. –ö–ª–∏–∫–∞–π—Ç–µ –Ω–∞ –∫–ª–µ—Ç–∫–∏ —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å/—É–±—Ä–∞—Ç—å –∫–æ–Ω—Ç—É—Ä", "info");
          } else {
            outlineModeBtn.classList.remove("active");
          }
        }

        // –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        newGameBtn.addEventListener("click", initGameBoard);
        outlineModeBtn.addEventListener("click", toggleOutlineMode);
        nextMoveBtn.addEventListener("click", toggleNextMoveMode);
        exportBtn.addEventListener("click", showExportModal);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞
        copyBtn.addEventListener("click", copyToClipboard);
        loadBtn.addEventListener("click", importBoard);
        closeExportModal.addEventListener("click", hideExportModal);

        importInput.addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            importBoard();
          }
        });

        // === –ö–û–î –î–õ–Ø –ú–û–î–ê–õ–ö–ò –ü–ï–†–í–û–ì–û –ó–ê–ü–£–°–ö–ê ===
        // –≠—Ç–æ—Ç –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ü–û–°–õ–ï–î–ù–ò–ú –≤ script

        // –ñ–¥—ë–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        window.addEventListener("load", function () {
          initTutorialModal();
        });

        function initTutorialModal() {
          const firstLaunchModal = document.getElementById("first-launch-modal");
          const closeFirstLaunchBtn = document.getElementById("first-launch-close");
          const prevStepBtn = document.getElementById("prev-step");
          const nextStepBtn = document.getElementById("next-step");
          const skipTutorialBtn = document.getElementById("skip-tutorial");
          const dontShowAgainCheckbox = document.getElementById("dont-show-again");
          const stepDots = document.querySelectorAll(".step-dot");
          const helpBtn = document.getElementById("help-btn");

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç
          if (!firstLaunchModal) {
            console.error("–ú–æ–¥–∞–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID");
            return;
          }

          let currentStep = 1;
          const totalSteps = 4;

          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —è—á–µ–π–∫–∏
          const demoCell = document.getElementById("demo-cell");
          const demoCellContent = document.getElementById("demo-cell-content");
          const demoStatus = document.getElementById("demo-status");

          let demoCellState = 0;
          const demoStates = [
            { class: "unknown", symbol: "?", text: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ" },
            { class: "normal", symbol: "", text: "–û–±—ã—á–Ω–∞—è" },
            { class: "gold", symbol: "‚òÖ", text: "–ó–æ–ª–æ—Ç–∞—è" },
          ];

          function initDemoCell() {
            if (demoCell) {
              updateDemoCell();
              demoCell.addEventListener("click", function () {
                demoCellState = (demoCellState + 1) % demoStates.length;
                updateDemoCell();
              });
            }
          }

          function updateDemoCell() {
            if (!demoCell) return;

            const state = demoStates[demoCellState];
            demoCell.className = "demo-cell";
            demoCell.classList.add(state.class);
            demoCellContent.textContent = state.symbol;
            demoStatus.textContent = `–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: ${state.text}`;
          }

          // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —à–∞–≥–æ–≤
          function goToStep(step) {
            // –°–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —à–∞–≥
            const currentStepEl = document.querySelector(`.tutorial-step[data-step="${currentStep}"]`);
            const currentDot = document.querySelector(`.step-dot[data-step="${currentStep}"]`);

            if (currentStepEl) currentStepEl.classList.remove("active");
            if (currentDot) currentDot.classList.remove("active");

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ–≤—ã–π —à–∞–≥
            currentStep = step;
            const newStepEl = document.querySelector(`.tutorial-step[data-step="${currentStep}"]`);
            const newDot = document.querySelector(`.step-dot[data-step="${currentStep}"]`);

            if (newStepEl) newStepEl.classList.add("active");
            if (newDot) newDot.classList.add("active");

            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            if (prevStepBtn) prevStepBtn.disabled = currentStep === 1;
            if (nextStepBtn) {
              nextStepBtn.textContent = currentStep === totalSteps ? "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É" : "–î–∞–ª–µ–µ";
            }
          }

          // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫—É
          function showTutorialModal() {
            firstLaunchModal.classList.add("active");
            document.body.style.overflow = "hidden";
            goToStep(1);
            initDemoCell();
          }

          function hideTutorialModal() {
            firstLaunchModal.classList.remove("active");
            document.body.style.overflow = "auto";

            if (dontShowAgainCheckbox && dontShowAgainCheckbox.checked) {
              localStorage.setItem("tutorialShown", "true");
            }
          }

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–æ–¥–∞–ª–∫—É
          const tutorialShown = localStorage.getItem("tutorialShown");
          if (!tutorialShown) {
            // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è
            setTimeout(showTutorialModal, 800);
          }

          // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
          if (nextStepBtn) {
            nextStepBtn.addEventListener("click", function () {
              if (currentStep < totalSteps) {
                goToStep(currentStep + 1);
              } else {
                hideTutorialModal();
                showToast("–¢–µ–ø–µ—Ä—å –≤—ã –≥–æ—Ç–æ–≤—ã –∫ –∏–≥—Ä–µ! –£–¥–∞—á–∏ –≤ –ø–æ–∏—Å–∫–µ –∑–æ–ª–æ—Ç–∞!", "success");
              }
            });
          }

          if (prevStepBtn) {
            prevStepBtn.addEventListener("click", function () {
              if (currentStep > 1) {
                goToStep(currentStep - 1);
              }
            });
          }

          if (skipTutorialBtn) {
            skipTutorialBtn.addEventListener("click", hideTutorialModal);
          }

          if (closeFirstLaunchBtn) {
            closeFirstLaunchBtn.addEventListener("click", hideTutorialModal);
          }

          if (stepDots) {
            stepDots.forEach((dot) => {
              dot.addEventListener("click", function () {
                const step = parseInt(this.getAttribute("data-step"));
                if (!isNaN(step)) {
                  goToStep(step);
                }
              });
            });
          }

          if (helpBtn) {
            helpBtn.addEventListener("click", showTutorialModal);
          }

          // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª–∫–∏
          firstLaunchModal.addEventListener("click", function (e) {
            if (e.target === firstLaunchModal) {
              hideTutorialModal();
            }
          });

          // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
          document.addEventListener("keydown", function (e) {
            if (e.key === "Escape" && firstLaunchModal.classList.contains("active")) {
              hideTutorialModal();
            }
          });

          // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
          closeModalBtn.addEventListener("click", closeModal);
          modalOverlay.addEventListener("click", function (e) {
            if (e.target === modalOverlay) {
              closeModal();
            }
          });

          // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
          document.addEventListener("keydown", function (e) {
            if (e.key === "Escape") {
              if (modalOverlay.classList.contains("active")) {
                closeModal();
              }
              if (exportImportModal.classList.contains("active")) {
                hideExportModal();
              }
            }
          });

          // –°—Ç–∏–ª–∏ –¥–ª—è –¥–µ–º–æ-—è—á–µ–π–∫–∏
          const demoCellStyles = `
                    .demo-cell.unknown { background-color: #bdc3c7; }
                    .demo-cell.normal { background-color: #ecf0f1; }
                    .demo-cell.gold {
                        background-color: #ffd700;
                        box-shadow: inset 0 0 10px rgba(184, 134, 11, 0.5);
                    }
                    .demo-cell.empty {
                        background-color: #7f8c8d;
                        color: white;
                    }
                `;

          const styleSheet = document.createElement("style");
          styleSheet.textContent = demoCellStyles;
          document.head.appendChild(styleSheet);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        initGameBoard();
        analyzeBoard();
      });
    </script>
    <!-- Cloudflare Web Analytics -->
    <script
      defer
      src="https://static.cloudflareinsights.com/beacon.min.js"
      data-cf-beacon='{"token": "2e3bf359d7ec48b5b643105f92866e55"}'
    ></script>
    <!-- End Cloudflare Web Analytics -->
  </body>
</html>
